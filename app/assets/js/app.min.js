angular.o("app", ["ui.router", "pascalprecht.translate", "ngMaterial", "chart.js", "ngStorage", "functions", "charts"]).i(["$translateProvider", "$translatePartialLoaderProvider", "$httpProvider", function (e, n, t) { e.u("$translatePartialLoader", { l: "./assets/json/translations/{lang}/{part}.json" }); e.s("en"); n.m("main"); e.p("escape"); if (!t.g.headers.get) { t.g.headers.get = {} } t.g.headers.get["v"] = "Mon, 26 Jul 1997 05:00:00 GMT"; t.g.headers.get["h"] = "no-cache"; t.g.headers.get["S"] = "no-cache" }]).i(function (e) { e.O = function (e) { return moment(e).format("DD.MM.YYYY") } }).controller("AppCtrl", ["$scope", "$mdDialog", "$timeout", "$q", "$log", "$rootScope", "$localStorage", "$sessionStorage", "$window", "$http", "$translate", "$translatePartialLoader", "functions", function (a, e, t, n, r, u, i, l, o, f, s, c, d) { u.T = l.P; u.$ = l.$; a.k = new Date; u.I = 1; if (navigator.userAgent.indexOf("MSIE") !== -1 || !!document.documentMode === true) { u.N = { title: "you are currently using internet explorer. some functionality may not work properly", description: "for a better experience in using the application, please use some of the modern browsers such as google chrome, mozilla firefox, microsoft edge etc." } } if (angular.M(l.$)) { if (l.$ !== null) { if (l.$.C === "demo") { u.D = s.J("you are currently working in a demo version") + ". " + s.J("some functions are disabled") + "."; u.F = s.J("activate full version") } } } u.G = function () { f({ url: l.i.L + "Calculations.asmx/Init", method: "POST", data: "" }).then(function (e) { u.A = JSON.parse(e.data.d); u.A.U = null; u.A.R = null }, function (e) { alert(e.data.d) }) }; var m = function () { if (location.search.substring(1, 5) == "lang") { var n = location.search.substring(6) } f.get("./config/config.json").then(function (e) { u.i = e.data; l.i = e.data; if (localStorage.language) { u.B(localStorage.language) } else { u.B(u.i.language) } if (angular.M(n)) { if (n == "hr" || n == "ba" || n == "sr" || n == "sr_cyrl" || n == "en") { u.B(n) } } if (l._ == true) { u.q() } if (angular.W(u.A)) { u.G() } if (localStorage.version) { if (localStorage.version != u.i.version) { t(function () { h() }, 600) } } else { t(function () { h() }, 600) } }) }; m(); u.j = function () { f({ url: l.i.L + "Files.asmx/GetFile", method: "POST", data: { Z: "users/" + u.$.Y, filename: "settings" } }).then(function (e) { u.H = angular.K(e.data.d); if (e.data.d != null) { if (u.H.language != "") { u.i.language = u.H.language } if (u.H.V != "") { u.i.V = u.H.V } } else { u.H = { language: u.i.language, V: u.i.V } } l.H = u.H }, function (e) { d.alert(s.J(e.data.d), "") }) }; u.B = function (e) { s.X(e); c.m("main"); u.i.language = e; if (typeof Storage !== "undefined") { localStorage.language = e } l.i.language = e; if (l.ee != undefined || l.ee != null) { u.q() } }; u.ne = function () { u.te = true; f({ url: l.i.L + "Foods.asmx/Load", method: "POST", data: { ae: l.ee, re: u.$.re, lang: u.i.language } }).then(function (e) { var n = JSON.parse(e.data.d); u.ie = n.ie.concat(n.oe); u.oe = n.oe; u.ue = n.ue; u.te = false }, function (e) { u.te = false; alert(e.data.d) }) }; u.le = function () { f({ url: l.i.L + "Calculations.asmx/LoadPal", method: "POST", data: "" }).then(function (e) { u.fe = JSON.parse(e.data.d) }, function (e) { alert(e.data.d) }) }; u.se = function () { f({ url: l.i.L + "Goals.asmx/Load", method: "POST", data: "" }).then(function (e) { u.ce = JSON.parse(e.data.d) }, function (e) { alert(e.data.d) }) }; u.de = function () { u.te = true; f({ url: l.i.L + "Activities.asmx/Load", method: "POST", data: "" }).then(function (e) { u.me = JSON.parse(e.data.d); angular.forEach(u.me, function (e, n) { u.me[n].pe = s.J(u.me[n].pe).replace("&gt;", "<").replace("&lt;", ">") }); u.te = false }, function (e) { u.te = false; alert(e.data.d) }) }; u.ge = function () { f({ url: l.i.L + "Diets.asmx/Load", method: "POST", data: "" }).then(function (e) { u.ve = JSON.parse(e.data.d); angular.forEach(u.ve, function (e, n) { u.ve[n].he = s.J(u.ve[n].he).replace("&gt;", "<").replace("&lt;", ">"); u.ve[n].Se = s.J(u.ve[n].Se).replace("&gt;", "<").replace("&lt;", ">"); u.ve[n].note = s.J(u.ve[n].note).replace("&gt;", "<").replace("&lt;", ">") }) }, function (e) { alert(e.data.d) }) }; u.q = function () { if (l.$ == null) { a.Oe("login"); u.ye = false } else { u.ne(); u.le(); u.se(); u.de(); u.ge() } }; a.Oe = function (e) { u.Te = "./assets/partials/" + e + ".html" }; var p = function () { if (l.xe == "" || l.xe == undefined || l.$ == null || l.$.C == "expired") { a.Oe("login"); u.ye = false } else { a.Oe("dashboard"); a.we = 0; u.ye = true } }; p(); var g = function () { if (u.Pe.be == null) { return false } if (u.Pe.height <= 0) { d.alert(s.J("height is required")); return false } if (u.Pe.weight <= 0) { d.alert(s.J("weight is required")); return false } if (u.Pe.$e.value <= 0) { d.alert(s.J("choose physical activity level")); return false } return true }; a.ke = function (e) { if (u.Pe !== undefined) { if (g() == false) { return false } if (u.Pe.Ie == null) { u.Ne = "assets/partials/meals.html"; u.Me = "meals"; d.alert(s.J("choose meals"), ""); return false } if (e == "menu" && u.Pe.Ie.length > 0 && !u.Ce && u.Pe.Ie[0].code == "B") { if (u.Pe.Ie[1].De == false && u.Pe.Ie[5].De == true) { u.Ne = "./assets/partials/meals.html"; d.alert(s.J("the selected meal combination is not allowed in the menu") + "!", u.Pe.Ie[5].title + " " + s.J("in this combination must be turned off") + "."); return false } if (u.Pe.Ie[3].De == false && u.Pe.Ie[5].De == true) { u.Ne = "./assets/partials/meals.html"; d.alert(s.J("the selected meal combination is not allowed in the menu") + "!", u.Pe.Ie[5].title + " " + s.J("in this combination must be turned off") + "."); return false } } if (e == "menu") { if (u.Je !== undefined) { u.Fe() } } if (e !== "clientsdata") { u.Ge(u.Pe) } } u.Ne = "./assets/partials/" + e + ".html"; u.Me = e }; a.ke("clientsdata"); a.Le = function () { l.P = null; l.$ = null; u.$ = null; l.xe = ""; l.username = ""; u.ye = false; u.Ae = null; u.ye = false; l._ = false; l.ee = null; u.D = null; u.Te = "assets/partials/login.html" }; u.Ge = function (e) { if (g() == false) { return false } if (u.Pe.Ie == null) { u.Ne = "assets/partials/meals.html"; u.Me = "meals"; d.alert(s.J("choose meals"), ""); return false } if (u.Pe.Ie.length > 0 && !u.Ce && u.Pe.Ie[0].code == "B") { if (u.Pe.Ie[1].De == false && u.Pe.Ie[5].De == true) { u.Ne = "assets/partials/meals.html"; d.alert(s.J("the selected meal combination is not allowed in the menu") + "!", u.Pe.Ie[5].title + " " + s.J("in this combination must be turned off") + "."); return false } if (u.Pe.Ie[3].De == false && u.Pe.Ie[5].De == true) { u.Ne = "assets/partials/meals.html"; d.alert(s.J("the selected meal combination is not allowed in the menu") + "!", u.Pe.Ie[5].title + " " + s.J("in this combination must be turned off") + "."); return false } } v(e) }; var v = function (e) { e.ae = u.$.ae; e.be = e.be == null ? u.Ae.be : e.be; e.Ue = d.Re(e.Ue); f({ url: l.i.L + "ClientsData.asmx/Save", method: "POST", data: { ae: l.ee, x: e, re: u.$.re } }).then(function (e) { u.Pe.Ue = new Date(u.Pe.Ue) }, function (e) { alert(e.data.d) }) }; a.Be = function () { u.D = null }; u._e = function (e) { if (e.code == "B") { return s.J("breakfast") } else if (e.code == "MS") { return s.J("morning snack") } else if (e.code == "L") { return s.J("lunch") } else if (e.code == "AS") { return s.J("afternoon snack") } else if (e.code == "D") { return s.J("dinner") } else if (e.code == "MBS") { return s.J("meal before sleep") } else return e.title }; a.Ee = function (e) { u.I = e; u.qe() }; a.We = { je: 0, Ze: 0, weight: 0, ze: 0, Ye: 0 }; a.He = function (e) { u.Pe.height = (e.je * 30.48 + e.Ze * 2.54).toFixed(1); u.Pe.weight = (e.weight * .45349237).toFixed(1); u.Pe.ze = (e.ze * 2.54).toFixed(1); u.Pe.Ye = (e.Ye * 2.54).toFixed(1) }; u.qe = function () { var e = u.Pe.height * .3937; a.We.je = parseInt(e / 12).toFixed(0); var n = e / 12 - parseInt(e / 12); var t = n * 12; a.We.Ze = t.toFixed(0); a.We.weight = (u.Pe.weight / .45349237).toFixed(0); a.We.ze = (u.Pe.ze / 2.54).toFixed(0); a.We.Ye = (u.Pe.Ye / 2.54).toFixed(0) }; a.Ke = function (e, n) { var t = []; for (var a = e; a <= n; a++) { t.push(a) } return t }; a.Qe = false; a.Ve = function () { a.Qe = !a.Qe }; a.Xe = function () { if (localStorage.en) { return d.nn(localStorage.en) } else { return 0 } }; var h = function () { e.show({ controller: S, tn: "assets/partials/popup/notification.html", parent: angular.an(document.body), rn: true, d: {} }).then(function (e) { window.location.reload(true) }, function () { window.location.reload(true) }) }; var S = function (e, n, t, a) { e.i = n.i; e.Qe = false; e.Ve = function () { e.Qe = !e.Qe }; if (typeof Storage !== "undefined") { localStorage.version = e.i.version } e.hide = function () { t.hide() }; e.cancel = function () { t.cancel() } }; var O = function () { if (typeof Storage !== "undefined") { if (!localStorage["in"]) { t(function () { y() }, 6e5) } } }; var y = function () { e.show({ controller: T, tn: "assets/partials/popup/socialshare.html", parent: angular.an(document.body), rn: true, d: {} }).then(function (e) { }, function () { }) }; var T = function (e, n, t, a) { localStorage["in"] = "ok"; e.hide = function () { t.hide() }; e.cancel = function () { t.cancel() } }; a.on = function () { x() }; var x = function () { e.show({ controller: w, tn: "assets/partials/popup/reportabug.html", parent: angular.an(document.body), rn: true, d: { $: u.$ } }).then(function (e) { }, function () { }) }; var w = function (t, a, r, e, i, o) { t.d = { description: null, email: o.un(e.$) ? null : e.$.email, ln: null, fn: null }; var n = function (e) { t.sn = null; t.cn = null; if (o.un(e.description)) { e.ln = i.J("description is required"); return false } if (o.un(e.email)) { e.fn = i.J("email is required"); return false } a.hide(); var n = e.description + " E-mail: " + e.email; r({ url: l.i.L + "Mail.asmx/SendMessage", method: "POST", data: { dn: l.i.email, mn: "BUG - " + e.email, pn: n, lang: u.i.language, gn: true } }).then(function (e) { o.alert(e.data.d, "") }, function (e) { o.alert(i.J(e.data.d), "") }) }; t.cancel = function () { a.cancel() }; t.confirm = function (e) { n(e) } } }]).controller("loginCtrl", ["$scope", "$http", "$localStorage", "$sessionStorage", "$window", "$rootScope", "functions", "$translate", "$mdDialog", function (t, a, e, i, n, o, u, r, l) { var f = "Users.asmx"; t.Oe = function (e) { t.vn = e }; t.Oe("loginTpl"); t.hn = function (e, n) { t.Sn = null; if (u.un(e) || u.un(n)) { t.On = true; t.Sn = r.J("enter user name (email) and password"); return false } o.te = true; a({ url: o.i.L + f + "/Login", method: "POST", data: { yn: e, password: n } }).then(function (e) { if (JSON.parse(e.data.d).ae != null) { o.$ = JSON.parse(e.data.d); if (o.$.ae !== o.$.Y && o.$.isActive === false) { o.te = false; t.On = true; t.Sn = r.J("your account is not active") + ". " + r.J("please contact your administrator"); return false } o.T = JSON.parse(e.data.d); i.P = o.T; i.xe = o.$.ae; i.ee = o.$.Y; i.username = o.$.yn; i.$ = o.$; i._ = true; o.ye = true; o.q(); if (typeof Storage !== "undefined") { localStorage.en = new Date } if (o.$.C == "expired") { o.ye = false; u.alert(r.J("your subscription has expired"), r.J("renew subscription")); o.Te = "./assets/partials/order.html" } else { o.Te = "./assets/partials/dashboard.html"; if (o.$.Tn <= 10 && o.$.Tn > 0) { o.D = r.J("your subscription will expire in") + " " + o.$.Tn + " " + (o.$.Tn == 1 ? r.J("day") : r.J("days")) + "."; o.F = r.J("renew subscription") } if (o.$.Tn == 0) { o.D = r.J("your subscription will expire today") + "."; o.F = r.J("renew subscription") } if (o.$.C == "demo") { o.D = r.J("you are currently working in a demo version") + ". " + r.J("some functions are disabled") + "."; o.F = r.J("activate full version") } if (o.i.language == "en") { o.I = 0 } else { o.I = 1 } } } else { o.te = false; t.On = true; t.Sn = r.J("wrong user name or password") } }, function (e) { t.On = true; t.Sn = r.J("user was not found") }) }; t.xn = function () { o.Te = "assets/partials/signup.html" }; t.wn = function () { l.show({ controller: t.bn, tn: "assets/partials/popup/forgotpassword.html", parent: angular.an(document.body), Pn: "", rn: true, fullscreen: t.$n, d: "" }).then(function (e) { }, function () { }) }; t.bn = function (e, n, t, a) { e.confirm = function (e) { r(e) }; var r = function (e) { t({ url: i.i.L + f + "/ForgotPassword", method: "POST", data: { email: e, lang: o.i.language } }).then(function (e) { n.hide(); u.alert(JSON.parse(e.data.d), "") }, function (e) { u.alert(e.data.d, "") }) }; e.hide = function () { n.hide() }; e.cancel = function () { n.cancel() } } }]).controller("signupCtrl", ["$scope", "$http", "$sessionStorage", "$window", "$rootScope", "functions", "$translate", function (n, e, t, a, r, i, o) { var u = "Users.asmx"; n.kn = false; n.In = ""; n.Nn = ""; n.Mn = false; n.accept = false; var l = function () { e({ url: t.i.L + u + "/Init", method: "POST", data: "" }).then(function (e) { n.Cn = JSON.parse(e.data.d) }, function (e) { alert(e.data.d) }) }; l(); n.xn = function () { n.Mn = true; n.Cn.yn = n.Cn.email; if (i.un(n.Cn.Dn) || i.un(n.Cn.Jn) || i.un(n.Cn.email) || i.un(n.Cn.password) || i.un(n.In) || i.un(n.Nn)) { i.alert(o.J("all fields are required"), ""); n.Mn = false; return false } if (n.Cn.email != n.Nn) { n.Mn = false; i.alert(o.J("emails are not the same"), ""); return false } if (n.Cn.password != n.In) { n.Mn = false; i.alert(o.J("passwords are not the same"), ""); return false } if (n.accept == false) { n.Mn = false; i.alert(o.J("you must agree to the terms and conditions"), ""); return false } n.Fn = true; e({ url: t.i.L + u + "/Signup", method: "POST", data: { x: n.Cn, lang: r.i.language } }).then(function (e) { n.Fn = false; if (e.data.d == "registration completed successfully") { n.Gn = e.data.d; n.kn = true } else { i.alert(o.J(e.data.d), "") } }, function (e) { n.kn = false; n.Mn = false; n.Fn = false; i.alert(o.J(e.data.d), "") }) } }]).controller("schedulerCtrl", ["$scope", "$localStorage", "$http", "$rootScope", "$timeout", "$sessionStorage", "$mdDialog", "functions", "$translate", function (o, e, n, u, r, t, a, i, l) { var f = "Scheduler.asmx"; o.id = "#myScheduler"; o.Ln = 0; o.An = u.$.ae; var s = function () { YUI().X("aui-scheduler", function (e) { var n = new e.Un; var t = new e.Rn; var a = new e.Bn; var r = new e._n; var i = new e.En({ qn: { save: function (e) { d(this.Wn(), e) }, jn: function (e) { d(this.Wn(), e) }, "delete": function (e) { p(this.Wn(), e) } } }); o.id = o.An == null ? "myScheduler" : o.An; new e.Zn({ zn: a, Yn: "#" + o.id, Ue: new Date, Hn: i, items: u.Kn, Qn: true, Vn: [t, a, r, n], Xn: { et: l.J("agenda"), nt: l.J("day_"), tt: l.J("month"), table: l.J("table"), k: l.J("today"), at: l.J("week"), rt: l.J("year") } }) }) }; var c = function () { n({ url: t.i.L + "Users.asmx/GetUsersByUserGroup", method: "POST", data: { Y: u.$.Y } }).then(function (e) { o.it = JSON.parse(e.data.d); o.ot(u.$.ae) }, function (e) { i.alert(l.J(e.data.d)) }) }; o.ot = function (e) { n({ url: t.i.L + f + "/GetSchedulerEvents", method: "POST", data: { $: u.$, Ln: o.Ln, An: e } }).then(function (e) { u.Kn = JSON.parse(e.data.d); r(function () { s() }, 200) }, function (e) { i.alert(l.J(e.data.d)) }) }; c(); var d = function (e, n) { u.Kn.push({ Ln: o.Ln, be: angular.M(u.Ae) && u.Ae != null ? u.Ae.be : null, content: n.ft[0].lt.ut.content, st: e.st, ct: e.ct, ae: u.$.ae }); var t = {}; t.Ln = o.Ln; t.be = angular.M(u.Ae) && u.Ae != null ? u.Ae.be : null; t.content = n.ft[0].lt.ut.content == null ? e.content : n.ft[0].lt.ut.content; t.st = e.st; t.ct = e.ct; t.ae = u.$.ae; var a = {}; a.Ln = o.Ln; a.be = angular.M(u.Ae) && u.Ae != null ? u.Ae.be : null; a.content = angular.W(n.ft[0].lt.dt.content) ? e.content : n.ft[0].lt.dt.content.pt; a.st = angular.W(n.ft[0].lt.dt.st) ? e.st : Date.parse(n.ft[0].lt.dt.st.pt); a.ct = angular.W(n.ft[0].lt.dt.ct) ? e.ct : Date.parse(n.ft[0].lt.dt.ct.pt); a.ae = u.$.ae; g(a); r(function () { m(t) }, 500) }; var m = function (e) { if (u.$.C == "demo") { i.gt("the saving function is disabled in demo version"); return false } if (u.$.re < 1) { i.gt("this function is available only in standard and premium package"); return false } n({ url: t.i.L + f + "/Save", method: "POST", data: { Y: u.$.Y, ae: u.$.ae, x: e } }).then(function (e) { v() }, function (e) { i.alert(l.J(e.data.d)) }) }; var p = function (e, n) { var t = {}; t.Ln = o.Ln; t.be = "0"; t.content = e.content; t.st = e.st; t.ct = e.ct; t.ae = u.$.ae; g(t) }; var g = function (e) { n({ url: t.i.L + f + "/Delete", method: "POST", data: { Y: u.$.Y, ae: u.$.ae, x: e } }).then(function (e) { v() }, function (e) { i.alert(l.J(e.data)) }) }; o.Oe = function (e) { u.Te = "./assets/partials/" + e + ".html" }; var v = function () { n({ url: t.i.L + f + "/GetAppointmentsCountByUserId", method: "POST", data: { Y: u.$.Y, ae: u.$.ae } }).then(function (e) { u.$.ht.vt = JSON.parse(e.data.d) }, function (e) { i.alert(l.J(e.data.d)) }) }; var h = function () { n({ url: t.i.L + f + "/RemoveAllEvents", method: "POST", data: { Y: u.$.Y } }).then(function (e) { o.An = null; v(); o.Oe("dashboard") }, function (e) { i.alert(l.J(e.data.d)) }) }; o.St = function () { var e = a.confirm().title(l.J("remove all events") + "?").ok(l.J("yes") + "!").cancel(l.J("no")); a.show(e).then(function () { h() }, function () { }) } }]).controller("userCtrl", ["$scope", "$http", "$sessionStorage", "$window", "$rootScope", "$mdDialog", "functions", "$translate", function (n, t, a, e, r, i, o, u) { var l = "Users.asmx"; n.Ot = [{ value: 0, text: "Supervizor" }, { value: 1, text: "Admin" }, { value: 2, text: "Student" }]; var f = function () { t({ url: a.i.L + l + "/Init", method: "POST", data: "" }).then(function (e) { n.Cn = JSON.parse(e.data.d); n.Cn.yt = 1; s() }, function (e) { o.alert(u.J(e.data.d)) }) }; var s = function () { t({ url: a.i.L + l + "/GetUsersByUserGroup", method: "POST", data: { Y: a.ee } }).then(function (e) { n.it = JSON.parse(e.data.d) }, function (e) { o.alert(u.J(e.data.d)) }) }; f(); n.yt = function (e) { switch (e) { case 0: return "Supervizor"; break; case 1: return "Admin"; break; case 2: return "Student"; break; default: return "" } }; n.xn = function () { if (r.$.C == "demo") { o.gt("this function is not available in demo version"); return false } if (n.it.length >= r.$.Tt) { o.alert(u.J("max number of users is") + " " + r.$.Tt, ""); return false } if (!angular.M(r.$)) { r.$ = n.Cn } n.Cn.yn = n.Cn.email; n.Cn.xt = r.$.xt; n.Cn.wt = r.$.wt; n.Cn.bt = r.$.bt; n.Cn.Pt = r.$.Pt; n.Cn.$t = r.$.$t; n.Cn.kt = r.$.kt; n.Cn.It = r.$.It; n.Cn.Y = r.$.Y; n.Cn.Nt = r.$.Nt; n.Cn.isActive = true; n.Cn.re = r.$.re; if (n.Cn.password == "" || n.In == "") { o.alert(u.J("enter password"), ""); return false } if (n.Cn.password != n.In) { o.alert(u.J("passwords are not the same"), ""); return false } n.Mt = true; t({ url: a.i.L + l + "/Signup", method: "POST", data: { x: n.Cn, lang: r.i.language } }).then(function (e) { s(); n.Mt = false; o.alert(u.J(e.data.d)) }, function (e) { n.Mt = false; o.alert(u.J(e.data.d)) }) }; n.update = function (e) { t({ url: a.i.L + l + "/Update", method: "POST", data: { x: e } }).then(function (e) { o.alert(u.J("saved"), "") }, function (e) { o.alert(u.J(e.data.d)) }) }; n.Ct = function (e) { t({ url: a.i.L + l + "/Get", method: "POST", data: { ae: e } }).then(function (e) { r.$ = JSON.parse(e.data.d); r.Te = "assets/partials/user.html" }, function (e) { o.alert(u.J(e.data.d)) }) }; n.Dt = function (e) { t({ url: a.i.L + l + "/Update", method: "POST", data: { x: e } }).then(function (e) { o.alert(u.J(e.data.d)) }, function (e) { o.alert(u.J(e.data.d)) }) }; n.remove = function (e) { var n = i.confirm().title(u.J("delete user") + "?").textContent(e.Dn + " " + e.Jn).Pn(e).ok(u.J("yes") + "!").cancel(u.J("no")); i.show(n).then(function () { c(e) }, function () { }) }; var c = function (e) { t({ url: a.i.L + l + "/Delete", method: "POST", data: { x: e } }).then(function (e) { s() }, function (e) { o.alert(u.J(e.data.d)) }) }; n.Jt = false; n.Ft = function () { n.Jt = n.Jt == true ? false : true }; var d = function () { t({ url: a.i.L + "Files.asmx/IsLogoExists", method: "POST", data: { ae: a.ee, filename: "logo.png" } }).then(function (e) { if (e.data.d == "TRUE") { n.Gt = true } else { n.Gt = false; n.Lt = null } }, function (e) { o.alert(u.J(e.data.d)) }) }; d(); n.Lt = "../upload/users/" + r.$.Y + "/logo.png?v=" + (new Date).getTime(); n.upload = function () { if (r.$.yt != 0) { return false } var e = new FormData(document.getElementById("formUpload")); t({ url: a.i.L + "/UploadHandler.ashx", method: "POST", headers: { At: undefined }, data: e }).then(function (e) { n.Gt = true; n.Lt = "../upload/users/" + r.$.Y + "/logo.png?v=" + (new Date).getTime(); if (e.data != "OK") { o.alert(u.J(e.data)) } d() }, function (e) { o.alert(u.J(e.data)) }) }; n.Ut = function (e) { if (e.yt != 0) { return false } var n = i.confirm().title(u.J("remove logo") + "?").Pn(e).ok(u.J("yes") + "!").cancel(u.J("no")); i.show(n).then(function () { m(e) }, function () { }) }; var m = function (e) { t({ url: a.i.L + "Files.asmx/DeleteLogo", method: "POST", data: { ae: e.ae, filename: "logo.png" } }).then(function (e) { n.Gt = false; n.Lt = null; if (e.data.d != "OK") { o.alert(u.J(e.data.d)) } }, function (e) { o.alert(u.J(e.data.d)) }) } }]).controller("mainCtrl", ["$scope", "$rootScope", function (e, n) { if (n.Ae) { if (n.Ae.be) { n.Ne = "assets/partials/clientsdata.html", n.Me = "clientsdata" } else { n.Ne = "assets/partials/dashboard.html", n.Me = "dashboard" } } else { n.Ne = "assets/partials/dashboard.html", n.Me = "dashboard" } }]).controller("dashboardCtrl", ["$scope", "$http", "$sessionStorage", "$rootScope", "functions", "$translate", "$timeout", function (n, e, t, a, r, i, o) { var u = function () { e({ url: t.i.L + "Users.asmx/Get", method: "POST", data: { ae: a.$.ae } }).then(function (e) { a.$ = JSON.parse(e.data.d); n.Nt = new Date(a.$.Nt) }, function (e) { r.alert(i.J(e.data.d)) }) }; u(); var l = function () { o(function () { if (a.Te == "./assets/partials/dashboard.html") { e({ url: t.i.L + "Clients.asmx/Load", method: "POST", data: { ae: t.ee, $: a.$ } }).then(function (e) { var n = JSON.parse(e.data.d); if (n.length == 0) { r.alert(i.J("need help") + "?", i.J("contact our technical support by email") + ": " + a.i.email + " " + i.J("or phone") + ": " + a.i.It + "."); t.Rt = true } }, function (e) { }) } }, 8e3) }; if (a.$.C == "demo" && a.i.language == "hr" && t.Rt === undefined) { l() } }]).controller("clientsCtrl", ["$scope", "$http", "$sessionStorage", "$window", "$rootScope", "$mdDialog", "$timeout", "charts", "$filter", "functions", "$translate", function (c, t, i, e, d, a, n, m, r, p, g) { var o = "Clients.asmx"; c.Bt = 0; c.Oe = function (e) { c._t = e }; c.Oe("inputData"); c.Et = function (e) { c.qt = e }; var u = function (e) { t({ url: i.i.L + "ClientsData.asmx/Init", method: "POST", data: { Ae: e } }).then(function (e) { d.Pe = JSON.parse(e.data.d); d.Pe.Ue = new Date(d.Pe.Ue) }, function (e) { p.alert(g.J(e.data.d), "") }) }; var l = function () { t({ url: i.i.L + "Clients.asmx/Init", method: "POST", data: "" }).then(function (e) { d.Ae = JSON.parse(e.data.d); d.Ae.Ue = new Date((new Date).setHours(0, 0, 0, 0)); c.d = d.Ae }, function (e) { p.alert(g.J(e.data.d), "") }) }; var f = function () { d.te = true; t({ url: i.i.L + o + "/Load", method: "POST", data: { ae: i.ee, $: d.$ } }).then(function (e) { d.Wt = JSON.parse(e.data.d); d.te = false }, function (e) { p.alert(g.J(e.data.d), ""); d.te = false }) }; f(); d.jt = function () { d.Zt = false; t({ url: i.i.L + o + "/Init", method: "POST", data: "" }).then(function (e) { d.Ae = JSON.parse(e.data.d); d.Ae.Ue = new Date((new Date).setHours(0, 0, 0, 0)); d.Pe = []; d.zt = []; d.G(); c.d = d.Ae; d.Yt = null; c.Ht() }, function (e) { p.alert(g.J(e.data.d), "") }) }; c.Ht = function () { a.show({ controller: c.Kt, tn: "assets/partials/popup/client.html", parent: angular.an(document.body), Pn: "", rn: true, d: c.d }).then(function (e) { d.Ae = e; d.Te = "./assets/partials/main.html"; c.ke("clientsdata"); c.get(d.Ae) }, function () { }) }; c.Kt = function (n, t, e, a, r) { n.d = e; n.d.Ue = new Date(n.d.Ue); n.d.Qt = new Date(n.d.Qt); n.$ = d.$; n.hide = function () { t.hide() }; n.cancel = function () { t.cancel() }; n.Vt = null; n.Vt = null; n.save = function (e) { if (e.Dn == "" || e.Dn == null) { n.Vt = "first name is required"; return false } else { n.Vt = null; if (p.nn(e.Qt) < 365) { n.Xt = "birth date is required"; return false } else { n.Xt = null } } e.ae = i.xe; e.Qt = p.Re(e.Qt); a({ url: i.i.L + o + "/Save", method: "POST", data: { $: d.$, x: e, lang: d.i.language } }).then(function (e) { if (JSON.parse(e.data.d).message != null) { p.alert(g.J(JSON.parse(e.data.d).message), ""); return false } f(); r(function () { t.hide(JSON.parse(e.data.d).data) }, 500) }, function (e) { p.alert(g.J(e.data.d), "") }) } }; c.jn = function (e) { t({ url: i.i.L + o + "/Get", method: "POST", data: { ae: i.ee, be: e.be } }).then(function (e) { c.d = JSON.parse(e.data.d); c.Ht() }, function (e) { alert(e.data.d) }) }; c.search = function () { t({ url: i.i.L + o + "/Load", method: "POST", data: { ae: i.ee, $: d.$ } }).then(function (e) { d.Wt = JSON.parse(e.data.d); c.d = JSON.parse(e.data.d); c.ea() }, function (e) { alert(e.data.d) }) }; c.ea = function () { a.show({ controller: c.na, tn: "assets/partials/popup/searchclients.html", parent: angular.an(document.body), Pn: "", rn: true, d: c.d }).then(function (e) { d.Ae = e; d.Te = "./assets/partials/main.html"; c.ke("clientsdata"); c.get(e) }, function () { }) }; c.na = function (n, t, e, a) { n.d = e; n.ta = 20; n.aa = function () { n.ta += 20 }; n.ra = function (e) { return new Date(e) }; n.hide = function (e) { t.hide(e) }; n.cancel = function () { t.cancel() }; n.get = function (e) { n.hide(e) }; n.ia = function () { t.cancel(); d.jt() }; n.remove = function (e) { var n = t.confirm().title(g.J("are you sure you want to delete") + "?").textContent(g.J("client") + ": " + e.Dn + " " + e.Jn).Pn(e).ok(g.J("yes")).cancel(g.J("no")); t.show(n).then(function () { r(e) }, function () { }) }; var r = function (e) { a({ url: i.i.L + o + "/Delete", method: "POST", data: { ae: i.ee, be: e.be, $: d.$ } }).then(function (e) { d.Wt = JSON.parse(e.data.d); d.Ae = []; d.Pe = [] }, function (e) { alert(e.data.d) }) } }; c.get = function (n) { d.Zt = false; t({ url: i.i.L + "ClientsData.asmx/Get", method: "POST", data: { ae: i.ee, be: n.be } }).then(function (e) { if (JSON.parse(e.data.d).id != null) { d.Pe = JSON.parse(e.data.d); d.Pe.Ue = new Date((new Date).setHours(0, 0, 0, 0)); c.oa(d.Pe.$e.value); v(); h(); if (d.Pe.ua.me == null) { d.Pe.ua.me = [] } if (d.Pe.ua.me.length > 0) { d.Zt = true } if (d.I == 0 && d.i.language == "en") { d.qe() } d.Yt = null } else { u(n) } }, function (e) { alert(e.data.d) }) }; c.oa = function (n) { t({ url: i.i.L + "Calculations.asmx/GetPalDetails", method: "POST", data: { la: n } }).then(function (e) { d.$e = JSON.parse(e.data.d); d.$e.value = n; d.Pe.$e = d.$e; c.Oe("inputData") }, function (e) { alert(e.data.d) }) }; c.fa = function (e) { t({ url: i.i.L + "ClientsData.asmx/GetClientLog", method: "POST", data: { ae: i.ee, be: e.be } }).then(function (e) { c.Oe("clientStatictic"); c.sa = JSON.parse(e.data.d); angular.forEach(c.sa, function (e, n) { e.Ue = new Date(e.Ue) }); if (d.Yt == null) { v() } else { T(c.Bt, c.ca) } }, function (e) { alert(e.data.d) }) }; c.da = function (e, n) { var t = a.confirm().title(g.J("delete record") + "?").textContent(g.J("record date") + ": " + r("date")(e.Ue, "dd.MM.yyyy") + ", " + g.J("mass") + ": " + e.weight + " kg").Pn(e).ok(g.J("yes")).cancel(g.J("no")); a.show(t).then(function () { s(e) }, function () { }) }; var s = function (n) { t({ url: i.i.L + "ClientsData.asmx/Delete", method: "POST", data: { ae: i.ee, Pe: n } }).then(function (e) { c.fa(n) }, function (e) { alert(e.data.d) }) }; c.ma = function (n) { var e = angular.pa(n); e.Ue = p.Re(e.Ue); t({ url: i.i.L + "ClientsData.asmx/UpdateClientLog", method: "POST", data: { ae: i.ee, Pe: e } }).then(function (e) { c.fa(n) }, function (e) { alert(e.data.d) }) }; var v = function () { t({ url: i.i.L + "Calculations.asmx/GetCalculation", method: "POST", data: { Ae: d.Pe } }).then(function (e) { d.zt = JSON.parse(e.data.d); T(c.Bt, c.ca) }, function (e) { if (e.data.d === undefined) { p.alert(g.J("you have to refresh the page. press Ctrl+F5") + ".", "") } else { p.alert(e.data.d, "") } }) }; var h = function () { t({ url: i.i.L + "Calculations.asmx/GetMyCalculation", method: "POST", data: { ae: i.ee, be: d.Ae.be } }).then(function (e) { d.A = JSON.parse(e.data.d) }, function (e) { alert(e.data.d) }) }; var S = function () { c.ga = [{ va: 7, title: "last 7 days" }, { va: 14, title: "last 14 days" }, { va: 30, title: "last 30 days" }, { va: 92, title: "last 3 months" }, { va: 180, title: "last 6 months" }, { va: 365, title: "last 12 months" }, { va: 1e5, title: "all" }]; c.ca = c.ga[2] }; S(); c.ha = function (e, n) { T(e, n) }; var O = function (e) { return { min: Math.round(18.5 * e * e / 1e4 * 10) / 10, max: Math.round(25 * e * e / 1e4 * 10) / 10 } }; c.Sa = function (e, n, t) { d.Yt = parseInt(e); T(n, t) }; var y = function (e, n, t, a, r, i) { var o = (a + p.Oa(r, i) * e / 7e3).toFixed(1); var u = 0; var l = d.Yt !== undefined ? parseInt(d.Yt) : 0; if (l == 0) { if (e == 0) { l = t.weight } else if (e > 0) { l = (O(t.height).min + O(t.height).max) / 2 } else { l = O(t.height).max } } if (n == 0) { u = t.weight } if (e > 0) { if (o <= l) { u = o } else { u = l } } else { if (o >= l) { u = o } else { u = l } } return u }; var T = function (t, e) { c.ya = []; var a = []; var r = []; var i = []; var o = []; var u = []; if (angular.M(d.zt.Ta)) { var l = 30; var f = 0; var s = d.zt.U - d.zt.R - d.zt.tee; if (e !== undefined) { l = e.va; c.ca = e } angular.forEach(c.sa, function (e, n) { if (p.nn(e.Ue) <= l) { c.ya.push(e); if (t == 0) { a.push(e.weight); r.push(O(e.height).min); i.push(O(e.height).max); f = y(s, n, e, c.sa[0].weight, c.sa[0].Ue, e.Ue); o.push(f) } if (t == 1) { a.push(e.ze); r.push(95) } if (t == 2) { a.push(e.Ye); r.push(97) } if (n % (Math.floor(c.sa.length / 31) + 1) === 0) { u.push(new Date(e.Ue).toLocaleDateString()) } else { u.push("") } } }) } d.xa = m.wa([g.J("measured value"), g.J("lower limit"), g.J("upper limit"), g.J("goal")], [a, r, i, o], u, ["#3399ff", "#ff3333", "#33ff33", "#ffd633"], { ba: true, Pa: true, $a: { display: true }, ka: { Ia: [{ display: true, Na: { display: true }, Ma: { Ca: false } }], Da: [{ display: true, Na: { display: true }, Ma: { Ca: false } }] } }, [{ label: g.J("measured value"), borderWidth: 1, type: "bar", fill: true }, { label: g.J("lower limit"), borderWidth: 2, type: "line", fill: false }, { label: g.J("upper limit"), borderWidth: 2, type: "line", fill: false }, { label: g.J("goal") + " (2 " + g.J("kg") + "/" + g.J("mo") + ")", borderWidth: 3, type: "line", fill: false, Ja: "#33ff33", Fa: "#43ff33" }]) }; d.Ga = function (e, n) { T(e, n) }; c.ra = function (e) { return new Date(e) }; c.La = function (e, n) { switch (n) { case "height": return d.Pe.height = d.Pe.height * 1 + e; break; case "weight": return d.Pe.weight = d.Pe.weight * 1 + e; break; case "waist": return d.Pe.ze = d.Pe.ze * 1 + e; break; case "hip": return d.Pe.Ye = d.Pe.Ye * 1 + e; break; default: return "" } }; c.Aa = null; c.Ua = false; c.Ra = function () { if (c.Ua == true) { return false } c.Ua = true; t({ url: i.i.L + "PrintPdf.asmx/ClientPdf", method: "POST", data: { ae: i.ee, Ae: d.Ae, Pe: d.Pe, lang: d.i.language, Ba: d.$.Ba } }).then(function (e) { c.Ua = false; var n = e.data.d; c.Aa = i.i.L + "upload/users/" + d.$.Y + "/pdf/" + n + ".pdf" }, function (e) { c.Ua = false; alert(e.data.d) }); c._a = function () { c.Aa = null } }; c.Ea = null; c.qa = function () { if (c.Ua == true) { return false } c.Ua = true; var e = null; if (document.getElementById("clientDataChart") != null) { e = document.getElementById("clientDataChart").toDataURL("image/png").replace(/^data:image\/(png|jpg);base64,/, "") } t({ url: i.i.L + "PrintPdf.asmx/ClientLogPdf", method: "POST", data: { ae: i.ee, Ae: d.Ae, Pe: d.Pe, sa: c.ya, lang: d.i.language, Wa: e, Ba: d.$.Ba } }).then(function (e) { c.Ua = false; var n = e.data.d; c.Ea = i.i.L + "upload/users/" + d.$.Y + "/pdf/" + n + ".pdf" }) }; c.ja = function () { c.Ea = null }; c.Za = function (e, n, t, a) { if (t === undefined) { return false } var r = 0; if (n.length - a == 1) return { za: r.toFixed(1), icon: "fa fa-circle text-success" }; switch (e) { case "weight": r = (t.weight - n[n.length - a - 2].weight).toFixed(1); break; case "waist": r = (t.ze - n[n.length - a - 2].ze).toFixed(1); break; case "hip": r = (t.Ye - n[n.length - a - 2].Ye).toFixed(1); break; default: r = 0; break } if (r > 0) { return { za: r, icon: "fa fa-arrow-up text-danger" } } if (r < 0) { return { za: r, icon: "fa fa-arrow-down text-info" } } if (r == 0) { return { za: r, icon: "fa fa-circle text-success" } } } }]).controller("detailCalculationOfEnergyExpenditureCtrl", ["$scope", "$http", "$sessionStorage", "$window", "$rootScope", "$mdDialog", "functions", "$translate", "$timeout", function (n, t, a, e, r, o, u, l, f) { r.Ya = { value: 0, duration: 0 }; var s = function () { t({ url: a.i.L + "DetailEnergyExpenditure.asmx/Init", method: "POST", data: "" }).then(function (e) { n.Ha = JSON.parse(e.data.d) }, function (e) { u.alert(l.J(e.data.d), "") }) }; s(); var c = function (e) { n.Ka = []; n.Qa = []; for (i = e; i < 25; i++) { n.Ka.push(i) } for (i = 0; i < 60; i = i + 5) { n.Qa.push(i) } }; var d = function () { n.from = { Va: 0, min: 0 }; n.Xa = { Va: 0, min: 0 }; c(0) }; d(); n.er = function () { r.Pe.ua.me = []; r.Pe.ua.nr = 0; r.Pe.ua.duration = 0; r.Ya.value = 0; r.Ya.duration = 0; n.save(r.Pe.ua.me); d() }; r.tr = function () { r.Zt = !r.Zt; s() }; var m = function () { var t = 0; angular.forEach(r.Pe.ua.me, function (e, n) { t = t + e.nr }); return t }; var p = function () { var t = 0; angular.forEach(r.Pe.ua.me, function (e, n) { t = t + e.duration }); return t }; n.ar = function (e) { if (g(n.from, n.Xa) == 0) { u.alert(l.J("the start time and end of activity can not be the same"), ""); return false } n.Ha.id = angular.K(e).id; n.Ha.pe = angular.K(e).pe; n.Ha.from.Va = n.from.Va; n.Ha.from.min = n.from.min; n.Ha.Xa.Va = n.Xa.Va; n.Ha.Xa.min = n.Xa.min; n.Ha.duration = g(n.from, n.Xa); n.Ha.nr = v(g(n.from, n.Xa), angular.K(e).rr); r.Pe.ua.me.push(angular.pa(n.Ha)); r.Ya.value = m(); r.Pe.ua.nr = r.Ya.value; r.Ya.duration = p(); r.Pe.ua.duration = r.Ya.duration; n.from = angular.pa(n.Xa); c(n.from.Va) }; var g = function (e, n) { return n.Va * 60 + n.min - (e.Va * 60 + e.min) }; var v = function (e, n) { return e * n }; n.save = function (e) { if (r.$.C == "demo") { u.gt("this function is not available in demo version"); return false } t({ url: a.i.L + "DetailEnergyExpenditure.asmx/Save", method: "POST", data: { ae: r.$.Y, be: r.Ae.be, me: e } }).then(function (e) { r.Pe.ua = JSON.parse(e.data.d) }, function (e) { u.alert(l.J(e.data.d), "") }) }; var h = function () { if (r.Pe.ua.me == null) { r.Pe.ua.me = [] } if (r.Pe.ua.me.length > 0) { r.Ya.value = m(); r.Ya.duration = p(); var e = r.Pe.ua.me[r.Pe.ua.me.length - 1]; n.from = { Va: e.Xa.Va, min: e.Xa.min }; n.Xa = { Va: e.Xa.Va, min: e.Xa.min }; c(e.Xa.Va) } }; f(function () { h() }, 1e3); n.ir = function () { if (n.Xa.Va == 24) { n.Xa.min = 0; n.Qa = []; n.Qa.push(0) } } }]).controller("calculationCtrl", ["$scope", "$http", "$sessionStorage", "$window", "$rootScope", "$mdDialog", "charts", "$timeout", "functions", "$translate", function (r, t, a, e, u, n, l, i, o, f) { var s = "Calculations.asmx"; r.ur = function (e) { if (e < 18.5) { return { text: "text-info", icon: "fa fa-exclamation" } } if (e >= 18.5 && e <= 25) { return { text: "text-success", icon: "fa fa-check" } } if (e > 25 && e < 30) { return { text: "text-warning", icon: "fa fa-exclamation" } } if (e >= 30) { return { text: "text-danger", icon: "fa fa-exclamation" } } }; r.lr = function (e) { if (e.value < e.sr) { return { text: "text-success", icon: "fa fa-check" } } if (e.value >= e.sr && e.value < e.cr) { return { text: "text-warning", icon: "fa fa-exclamation" } } if (e.value >= e.cr) { return { text: "text-danger", icon: "fa fa-exclamation" } } }; var c = function () { google.dr.load("current", { mr: ["gauge"] }); i(function () { d(); m(); p() }, 1e3) }; var d = function () { var e = "bmiChart"; var n = u.zt.pr.value.toFixed(1); var t = "BMI"; var a = { title: "BMI", min: 15, max: 34, gr: 18.5, vr: 25, hr: 25, Sr: 30, Or: 30, yr: 34, Tr: 5 }; google.dr.xr(l.wr(e, n, t, a)) }; var m = function () { var e = "whrChart"; var n = u.zt.br.value.toFixed(1); var t = "WHR"; var a = u.zt.br.sr; var r = u.zt.br.cr; var i = u.zt.br.Pr; var o = { title: "WHR", min: 0, max: 1.6, gr: i - .1, vr: a, hr: a, Sr: r, Or: r, yr: 1.6, Tr: .1 }; google.dr.xr(l.wr(e, n, t, o)) }; var p = function () { var e = "waistChart"; var n = u.zt.ze.value.toFixed(1); var t = u.zt.ze.sr; var a = u.zt.ze.cr; var r = "cm"; var i = { title: "WHR", min: 0, max: 140, gr: 70, vr: t, hr: t, Sr: a, Or: a, yr: 140, Tr: 5 }; google.dr.xr(l.wr(e, n, r, i)) }; var g = function () { t({ url: a.i.L + "Goals.asmx/Load", method: "POST", data: "" }).then(function (e) { u.ce = JSON.parse(e.data.d); v() }, function (e) { alert(e.data.d) }) }; if (u.Yt === undefined) { u.Yt = 0 } r.Sa = function (e) { u.Yt = angular.pa(e) }; r.$r = function (e) { var t = e.code; if (e.isDisabled) { return false } var n = 0; var a = 0; u.kr = 0; switch (t) { case "G1": if (u.Nr.Ir.code == "G1") { n = u.Nr.U; a = u.Nr.R } if (u.Nr.Ir.code == "G2") { n = u.Nr.tee - 300; a = u.Nr.R } if (u.Nr.Ir.code == "G3") { n = u.Nr.U + 300; a = u.Nr.R } if (u.Nr.Ir.code == "G2") { u.kr = Math.round(angular.pa(u.Pe.weight)) } else { u.kr = Math.round(angular.pa(u.zt.Ta.max)) } break; case "G2": if (u.Nr.Ir.code == "G1") { n = u.Nr.tee + u.Nr.R; a = u.Nr.R } if (u.Nr.Ir.code == "G2") { n = u.Nr.U; a = u.Nr.R } if (u.Nr.Ir.code == "G3") { n = u.Nr.U - 300; a = u.Nr.R } u.kr = Math.round(angular.pa(u.Pe.weight)); break; case "G3": if (u.Nr.Ir.code == "G1") { n = u.Nr.U; a = u.Nr.R } if (u.Nr.Ir.code == "G2") { n = u.Nr.U + 300 + u.Nr.R; a = u.Nr.R } if (u.Nr.Ir.code == "G3") { n = u.Nr.U; a = u.Nr.R } if (u.Nr.Ir.code == "G4") { n = u.Nr.U + 500; a = u.Nr.R + 200 } if (u.Nr.Ir.code == "G2") { u.kr = Math.round(angular.pa(u.zt.Ta.max)) } else { u.kr = u.Pe.weight < u.zt.Ta.min ? Math.round(angular.pa(u.zt.Ta.min)) : Math.round(angular.pa(parseInt(u.Pe.weight) + 10)) } break; case "G4": if (u.Nr.Ir.code == "G1") { n = u.Nr.tee + u.Nr.R; a = u.Nr.R + 200 } if (u.Nr.Ir.code == "G2") { n = u.Nr.tee + 500; a = u.Nr.R + 200 } if (u.Nr.Ir.code == "G3") { n = u.Nr.U + 400; a = u.Nr.R + 100 } if (u.Nr.Ir.code == "G2") { u.kr = u.Pe.weight < u.zt.Ta.min ? Math.round(angular.pa(u.zt.Ta.min)) : Math.round(angular.pa(parseInt(u.Pe.weight) + 10)) } else { u.kr = Math.round(angular.pa(u.Pe.weight)) } break; default: n = 0; a = 0; break } r.Sa(u.kr); angular.forEach(u.ce, function (e, n) { if (e.code == t) { u.Pe.Ir.code = e.code; u.Pe.Ir.title = e.title; u.zt.Ir.code = t } }); u.zt.U = Math.round(n); u.zt.R = Math.round(a) }; var v = function () { if (u.zt.pr.value < 18.5) { u.ce[0].isDisabled = true } if (u.zt.pr.value > 25) { u.ce[2].isDisabled = true } }; r.Ua = false; r.Mr = function () { r.Ua = true; t({ url: a.i.L + "PrintPdf.asmx/CalculationPdf", method: "POST", data: { ae: a.ee, Ae: u.Ae, Pe: u.Pe, zt: u.zt, A: u.A, Ir: u.Yt, lang: u.i.language, Ba: u.$.Ba } }).then(function (e) { var n = e.data.d; r.Ua = false; r.Aa = a.i.L + "upload/users/" + u.$.Y + "/pdf/" + n + ".pdf" }, function (e) { r.Ua = false; alert(e.data.d) }) }; r._a = function () { r.Aa = null }; r.Cr = function () { u.G() }; r.Dr = function (e) { if (u.$.C == "demo") { o.gt("the saving function is disabled in demo version"); return false } var n = angular.pa(u.zt); n.U = e.U; n.R = e.R; t({ url: a.i.L + "Calculations.asmx/SaveMyCalculation", method: "POST", data: { ae: a.ee, be: u.Ae.be, A: n } }).then(function (e) { o.alert(f.J(e.data.d), "") }, function (e) { o.alert(f.J(e.data.d), "") }) }; var h = function () { t({ url: a.i.L + s + "/GetCalculation", method: "POST", data: { Ae: u.Pe } }).then(function (e) { u.zt = JSON.parse(e.data.d); u.Nr = JSON.parse(e.data.d); if (u.Pe.Ir.code == undefined || u.Pe.Ir.code == null || u.Pe.Ir.code == 0) { u.Pe.Ir.code = u.zt.Ir.code } c(); g(); r.$r(u.Pe.Ir) }, function (e) { if (e.data.d === undefined) { o.alert(f.J("you have to refresh the page. press Ctrl+F5") + ".", "") } else { o.alert(e.data.d, "") } }) }; h(); r.Jr = function (e) { if (u.$.C == "demo") { o.gt("this function is not available in demo version"); return false } if (u.$.re < 1) { o.gt("this function is available only in standard and premium package"); return false } h() } }]).controller("activitiesCtrl", ["$scope", "$http", "$sessionStorage", "$window", "$rootScope", "$mdDialog", "functions", "$translate", function (a, e, n, t, i, r, o, u) { var l = "Activities.asmx"; a.Fr = "-"; a.Gr = function (e) { var n = a.Fr == "+" ? "-" : "+"; a.order = n + e; a.Fr = n }; a.Gr("activity"); a.nr = 0; if (i.me == undefined) { i.de() } if (angular.M(i.Nr) && angular.M(i.A)) { if (!o.un(i.A.R)) { i.zt.R = i.A.R } } else { i.Ne = "./assets/partials/calculation.html"; i.Me = "calculation" } var f = function () { var t = 0; if (i.Pe.me.length > 0) { angular.forEach(i.Pe.me, function (e, n) { t = t + e.nr }) } a.nr = t.toFixed(); return i.zt.R - t }; f(); a.Ht = function (e) { energyLeft = f(); if (energyLeft > 10) { r.show({ controller: a.Kt, tn: "assets/partials/popup/activity.html", parent: angular.an(document.body), Pn: "", rn: true, fullscreen: a.$n, d: { pe: e, nr: energyLeft } }).then(function (e) { energyLeft = e; f() }, function () { }) } else { o.alert(u.J("the selected additional energy expenditure is the same as recommended"), "") } }; a.Kt = function (n, t, e, a) { n.d = e.pe; var r = e.nr; n.duration = Math.round(r / (n.d.rr * i.Pe.weight) * 60); n.cancel = function () { t.cancel() }; n.confirm = function (e) { r = n.duration * (n.d.rr * i.Pe.weight) / 60; i.Pe.me.push({ id: e.id, pe: e.pe, duration: n.duration, nr: r }); t.hide(r) } }; a.Lr = function (e, n) { var t = r.confirm().title(u.J("delete choosen activity")).textContent(e.title).Pn(e).ok(u.J("yes")).cancel(u.J("no")); r.show(t).then(function () { i.Pe.me.splice(n, 1); f() }, function () { }) } }]).controller("dietsCtrl", ["$scope", "$http", "$sessionStorage", "$window", "$rootScope", "$mdDialog", "functions", function (e, n, t, a, r, i, o) { var u = "Diets.asmx"; var l = function (e) { n({ url: t.i.L + u + "/Get", method: "POST", data: { id: e } }).then(function (e) { var n = JSON.parse(e.data.d); r.Pe.he = n }, function (e) { alert(e.data.d) }) }; var f = function () { var e = r.Pe.Ar; var n = ""; var t = r.Pe.Ir.code; if (e < 14) { switch (t) { case "G1": n = "d4"; break; case "G2": n = "d1"; break; case "G3": n = "d1"; break; case "G4": n = "d7"; break; default: n = "d1"; break } } if (e >= 14 && e < 18) { switch (t) { case "G1": n = "d5"; break; case "G2": n = "d2"; break; case "G3": n = "d2"; break; case "G4": n = "d7"; break; default: n = "d2"; break } } if (e >= 18) { switch (t) { case "G1": n = "d6"; break; case "G2": n = "d3"; break; case "G3": n = "d3"; break; case "G4": n = "d7"; break; default: n = "d3"; break } } l(n) }; if (r.Pe.he.id == null) { f() } e.select = function (e) { r.Pe.he = e } }]).controller("mealsCtrl", ["$scope", "$http", "$sessionStorage", "$window", "$rootScope", "$mdDialog", "functions", "$translate", function (e, n, t, a, r, i, o, u) { var l = "Meals.asmx"; e.Ur = function (e) { r.Rr = e; r.Br = true; if (e === "myMeals") { r.Pe.Ie = r.Je.data.Ie } }; var f = function () { if (r._r !== undefined) { if (r._r.id != null) { if (r._r.data.Ie.length > 0) { if (r._r.data.Ie[0].code == "B") { r.Rr = "standardMeals" } else { r.Rr = "myMeals" } return false } } } if (r.Pe.Je !== undefined && r.Pe.Je != null) { if (r.Pe.Je.data != null) { if (r.Pe.Je.data.Ie.length >= 2) { r.Rr = "myMeals" } else { r.Rr = "standardMeals" } } else { r.Rr = "standardMeals" } } else { r.Rr = "standardMeals" } }; f() }]).controller("standardMealsCtrl", ["$scope", "$http", "$sessionStorage", "$window", "$rootScope", "$mdDialog", "functions", "$translate", function (e, n, t, a, r, i, o, u) { var l = "Meals.asmx"; r.Ce = false; var f = function () { n({ url: t.i.L + l + "/Load", method: "POST", data: "" }).then(function (e) { r.Pe.Ie = JSON.parse(e.data.d); angular.forEach(r.Pe.Ie, function (e, n) { r.Pe.Ie[n].title = u.J(r.Pe.Ie[n].title) }) }, function (e) { alert(e.data.d) }) }; if (r.Pe.Ie.length == 0) { f() } else if (r.Pe.Ie[0].code != "B") { f() } }]).controller("myMealsCtrl", ["$scope", "$http", "$sessionStorage", "$window", "$rootScope", "$mdDialog", "functions", "$translate", function (n, t, i, e, o, a, r, u) { var l = "MyMeals.asmx"; var f = function () { t({ url: i.i.L + l + "/Init", method: "POST", data: { $: o.$ } }).then(function (e) { o.Je = JSON.parse(e.data.d); o.Pe.Je = angular.pa(o.Je); o.Pe.Ie = o.Pe.Je.data.Ie; o.Ce = true }, function (e) { alert(e.data.d) }) }; var s = function () { if (o._r !== undefined) { if (o._r.id != null) { return false } } if (o.Pe.Je !== undefined && o.Pe.Je != null) { if (o.Pe.Je.data != null) { if (o.Pe.Je.data.Ie.length > 0) { o.Je = angular.pa(o.Pe.Je) } } else { f() } } else { f() } }; var c = function () { if (!angular.M(o.Je)) { t({ url: i.i.L + l + "/Init", method: "POST", data: { $: o.$ } }).then(function (e) { o.Je = JSON.parse(e.data.d); s(); o.Ce = true }, function (e) { alert(e.data.d) }) } else { s() } }; c(); n.Er = function () { if (o.$.re < 2) { return false } f() }; n.qr = function () { if (o.$.re < 2) { return false } t({ url: i.i.L + l + "/Template", method: "POST", data: { $: o.$, lang: o.i.language } }).then(function (e) { o.Je = JSON.parse(e.data.d); if (o.$.re > 2) { o.Pe.Je = angular.pa(o.Je); o.Pe.Ie = o.Pe.Je.data.Ie } o.Ce = true; o.Br = true }, function (e) { alert(e.data.d) }) }; var d = function () { if (o.Je !== undefined) { if (o.Je.data != null) { if (o.Je.data.Ie.length > 0) { angular.forEach(o.Je.data.Ie, function (e, n) { e.code = "MM" + n; o.Je.data.jr[n].Wr.code = e.code }); o.Ce = true; o.Pe.Je = angular.pa(o.Je) } } } }; n.add = function () { if (o.Je === undefined) { f() } else { m() } }; o.Fe = function () { if (o.Ce) { d() } }; var m = function () { if (o.$.re < 2) { return false } if (o.Je.data.Ie.length >= 9) { r.alert(u.J("you have reached the maximum number of meals"), ""); return false } o.Je.data.Ie.push({ code: "", title: "", description: "", De: true, isDisabled: false }); o.Je.data.jr.push({ Wr: { code: "", Zr: 0, zr: 0, Yr: 0, Hr: 0 } }); d() }; n.Kr = function (e) { if (o.$.re < 2) { return false } o.Je.data.Ie.splice(e, 1); o.Je.data.jr.splice(e, 1); d() }; n.save = function () { if (o.$.C == "demo") { r.gt("the saving function is disabled in demo version"); return false } if (o.$.re < 2) { return false } if (o.Je.data.Ie.length < 3) { r.alert(u.J("choose at least 3 meals"), ""); return false } if (r.un(o.Je.title)) { r.alert(u.J("title is required"), ""); return false } t({ url: i.i.L + l + "/Save", method: "POST", data: { ae: i.ee, x: o.Je } }).then(function (e) { if (e.data.d != "error") { o.Je = JSON.parse(e.data.d); o.Pe.Je = angular.pa(o.Je); o.Ce = true } else { r.alert(u.J("meals with the same name already exists"), "") } }, function (e) { r.alert(u.J(e.data.d), "") }) }; n.remove = function (e) { if (o.$.re < 2) { return false } var n = a.confirm().title(u.J("delete meals") + "?").textContent().Pn().ok(u.J("yes")).cancel(u.J("no")); a.show(n).then(function () { remove(e) }, function () { }) }; remove = function (e) { t({ url: i.i.L + l + "/Delete", method: "POST", data: { ae: i.ee, id: e } }).then(function (e) { n.Qr = JSON.parse(e.data.d); f() }, function (e) { r.alert(u.J(e.data.d), "") }) }; n.search = function () { p() }; var p = function () { if (o.$.re < 2) { return false } a.show({ controller: g, tn: "assets/partials/popup/mymeals.html", parent: angular.an(document.body), rn: true }).then(function (e) { o.Je = e; o.Pe.Je = angular.pa(o.Je); o.Pe.Ie = o.Pe.Je.data.Ie; o.Ce = true; o.Br = true }, function () { }) }; var g = function (n, t, a) { n.ta = 20; n.aa = function () { n.ta += 20 }; var e = function () { n.te = true; a({ url: i.i.L + "MyMeals.asmx/Load", method: "POST", data: { ae: o.$.Y } }).then(function (e) { n.d = JSON.parse(e.data.d); n.te = false }, function (e) { n.te = false; alert(e.data.d) }) }; e(); n.cancel = function () { t.cancel() }; var r = function (e) { a({ url: i.i.L + "MyMeals.asmx/Get", method: "POST", data: { ae: o.$.Y, id: e.id } }).then(function (e) { n.Ie = JSON.parse(e.data.d); t.hide(n.Ie) }, function (e) { alert(e.data.d) }) }; n.confirm = function (e) { r(e) } } }]).controller("menuCtrl", ["$scope", "$http", "$sessionStorage", "$window", "$rootScope", "$mdDialog", "charts", "$timeout", "functions", "$translate", function (p, a, g, e, v, r, h, d, m, i) { var S = "Foods.asmx"; p.Vr = "fa fa-plus"; p.Xr = false; function initPrintSettings() { a({ url: g.i.L + "PrintPdf.asmx/InitMenuSettings", method: "POST", data: {} }).then(function (e) { v.ei = JSON.parse(e.data.d) }, function (e) { alert(e.data.d) }) } initPrintSettings(); v.ni = v.ni == undefined ? [] : v.ni; if (v.Pe.Ie.length < 3) { v.Ne = "assets/partials/meals.html"; v.Me = "meals"; m.alert(i.J("choose at least 3 meals"), "") } var n = function (e) { var n = null; if (e.Je !== undefined && e.Je != null) { if (e.Je.data != null) { if (e.Je.data.Ie.length >= 2 && v.Ce == true) { e.Ie = e.Je.data.Ie; n = e.Je.data.jr } } } a({ url: g.i.L + S + "/GetRecommendations", method: "POST", data: { Ae: e, ti: v.A.U, ai: n } }).then(function (e) { v.ri = JSON.parse(e.data.d); y() }, function (e) { if (e.data.d === undefined) { m.alert(i.J("you have to refresh the page. press Ctrl+F5") + ".", "") } else { m.alert(e.data.d, "") } }) }; var t = function () { a({ url: g.i.L + S + "/Init", method: "POST", data: { lang: v.i.language } }).then(function (e) { p.ii = e.data.d.ii; o() }, function (e) { alert(e.data.d) }) }; var o = function () { a({ url: g.i.L + "Menues.asmx/Init", method: "POST", data: {} }).then(function (e) { v._r = JSON.parse(e.data.d); v._r.Ae = v.Ae; v._r.Ae.Pe = v.Pe; v._r.data.Ie = v.Pe.Ie; if (v.Rr === "myMeals") { v._r.data.Ie = v.Je.data.Ie; angular.forEach(v._r.data.Ie, function (e, n) { if (e.description !== "") { v._r.data.Ie[n].description = e.description + "~" } }) } v.oi = "B"; if (v._r !== undefined) { if (v._r.data !== null) { if (v._r.data.Ie.length > 0) { v.oi = v._r.data.Ie[0].code } } } O(v._r); n(v._r.Ae.Pe) }, function (e) { alert(e.data.d) }) }; p.ui = function (e) { v.oi = e }; if (v.Br) { v.Br = false; t() } else { if (v._r === undefined) { t() } else { if (v._r.data.ni.length == 0) { t() } else { var u = v._r.data.Ie; v._r.data.Ie = angular.pa(v.Pe.Ie); angular.forEach(v._r.data.Ie, function (e, n) { if (n >= v._r.data.Ie.length || n >= u.length) { return false } if (u[n].code == e.code && v._r.data.ni.length > 0) { e.description = u[n].description } }); v._r.Ae = v.Ae; v._r.Ae.Pe = v.Pe } } } p.li = function (e) { p.te = true; d(function () { p.te = false; p.fi = e; if (v.si == "dailyMenuTpl") { O(v._r) } else { D(v.di.ci) } }, 700) }; p.li("chartsTpl"); p.mi = function (e, n, t) { if (e.pi > 1e-4 && isNaN(e.pi) == false && e.gi > 1e-4 && isNaN(e.gi) == false) { p.vi = null; angular.forEach(v._r.data.ni[t].hi, function (e, n) { if (e.De == true) { p.vi = e } }); d(function () { a({ url: g.i.L + S + "/ChangeFoodQuantity", method: "POST", data: { Si: v._r.data.Oi[t], yi: e.pi, Ti: e.gi, type: n, xi: p.vi } }).then(function (e) { v._r.data.ni[t] = JSON.parse(e.data.d); O(v._r) }, function (e) { }) }, 600) } }; p.La = function (e, n, t) { if (v._r.data.ni[t].pi + e > 0) { if (n == "quantity") { v._r.data.ni[t].pi = v._r.data.ni[t].pi * 1 + e; p.mi(v._r.data.ni[t], "quantity", t) } if (n == "mass") { v._r.data.ni[t].gi = v._r.data.ni[t].gi * 1 + e; p.mi(v._r.data.ni[t], "mass", t) } } }; p.wi = function (e, n) { p.Xr = true; p.Vr = "fa fa-spinner fa-spin"; if (v.$.C == "demo" && v._r.data.ni.length > 9) { m.gt("in demo version maximum number of choosen foods is 10"); p.Vr = "fa fa-plus"; p.Xr = false; return false } r.show({ controller: v.bi, tn: "assets/partials/popup/food.html", parent: angular.an(document.body), rn: true, d: { ie: v.ie, oe: v.oe, ue: v.ue, ii: e, Pi: n, i: v.i } }).then(function (e) { p.Vr = "fa fa-plus"; p.Xr = false; if (e.$i !== undefined) { if (e.$i == true) { v.Ne = "./assets/partials/myfoods.html"; v.Me = "myfoods"; v.ki = e.Si } else { p.Ii(e.ii, e.Si, n) } } else { p.Ii(e.ii, e.Si, n) } }, function () { p.Vr = "fa fa-plus"; p.Xr = false }) }; v.bi = function (a, t, e, r, i) { a.d = e; a.ie = e.ie; a.oe = e.oe; a.ue = e.ue; var o = null; var n = function (e) { r({ url: g.i.L + "Foods.asmx/InitFoodForEdit", method: "POST", data: { ii: e } }).then(function (e) { o = JSON.parse(e.data.d) }, function (e) { alert(e.data.d) }) }; var u = false; if (e.ii == null) { a.ii = null; o = null; u = false } else { a.ii = e.ii; n(e.ii); u = true } a.ta = 100; a.Ni = function () { a.Mi = { code: "A", title: "all foods" } }; a.Ni(); var l = function () { r({ url: g.i.L + "Foods.asmx/InitThermalTreatment", method: "POST", data: "" }).then(function (e) { a.vi = JSON.parse(e.data.d) }, function (e) { alert(e.data.d) }) }; l(); a.Ci = function (e) { a.Di = e }; a.Ji = function (n) { if (a.Di == true) { f(n); return false } r({ url: g.i.L + "Foods.asmx/Get", method: "POST", data: { ae: v.$.ae, id: JSON.parse(n).id } }).then(function (e) { a.ii = JSON.parse(e.data.d); if (a.ii.id === null) { f(n) } else { a.ii.ii = i.J(a.ii.ii); a.ii.Fi = i.J(a.ii.Fi); a.ii.Gi.title = i.J(a.ii.Gi.title); a.ii.Wr.title = i.J(a.ii.Wr.title); angular.forEach(a.ii.hi, function (e, n) { a.ii.hi[n].xi.title = i.J(a.ii.hi[n].xi.title) }); o = angular.pa(a.ii) } }, function (e) { alert(e.data.d) }) }; var f = function (e) { r({ url: g.i.L + "MyFoods.asmx/Get", method: "POST", data: { ae: v.$.Y, id: JSON.parse(e).id } }).then(function (e) { a.ii = JSON.parse(e.data.d); a.ii.Fi = i.J(a.ii.Fi); a.ii.Gi.title = i.J(a.ii.Gi.title); o = angular.pa(a.ii) }, function (e) { alert(e.data.d) }) }; var s = 0; a.Li = function (e, n) { if (m.un(n)) { n = s } angular.forEach(e, function (e, n) { e.De = false }); a.vi = e[n]; e[n].De = true; s = n; if (u) { u = false } else { c(a.vi) } }; var c = function (e) { r({ url: g.i.L + "Foods.asmx/IncludeThermalTreatment", method: "POST", data: { Si: o, ii: a.ii, xi: e } }).then(function (e) { a.ii = JSON.parse(e.data.d) }, function (e) { alert(e.data.d) }) }; a.cancel = function () { t.cancel() }; a.confirm = function (e) { var n = { ii: e, Si: o }; t.hide(n) }; a.mi = function (e, n) { u = false; if (e.pi > 1e-4 && isNaN(e.pi) == false && e.gi > 1e-4 && isNaN(e.gi) == false) { var t = a.ii.ii; d(function () { r({ url: g.i.L + S + "/ChangeFoodQuantity", method: "POST", data: { Si: o, yi: e.pi, Ti: e.gi, type: n, xi: a.vi } }).then(function (e) { a.ii = JSON.parse(e.data.d); a.ii.ii = t }, function (e) { }) }, 600) } }; a.La = function (e, n) { if (a.ii.pi + e > 0) { if (n == "quantity") { a.ii.pi = a.ii.pi + e; a.mi(a.ii, "quantity") } if (n == "mass") { a.ii.gi = a.ii.gi + e; a.mi(a.ii, "mass") } } }; a.Ai = function (e) { if (e.parent == "A") { a.Ui = e.group.code } }; a.Ri = function (e) { a.Bi = ""; a.ta = a.ie.length + 1; if (e.code === "MYF") { a.Ci(true) } else { a.Ci(false) } a.Mi = { code: e.code, title: e.title } }; a._i = function (e) { if (e.Gi.code == a.Mi.code || a.Mi.code == "A" || a.Di == true) { return true } else { if (a.Mi.code == a.Ui) { if (e.Gi.parent == a.Mi.code) { return true } } else { return false } } }; a.aa = function () { a.ta = a.ta + a.ie.length }; a.$i = function (e) { var n = { ii: e, Si: o, $i: true }; t.hide(n) } }; p.Ii = function (t, e, n) { if (t.ii != undefined || t.ii != null) { t.Wr.code = v.oi; angular.forEach(v.Pe.Ie, function (e, n) { if (e.code == t.Wr.code) { t.Wr.title = i.J(e.title) } }); if (n == undefined) { v._r.data.ni.push(t); v._r.data.Oi.push(e) } else { v._r.data.ni[n] = t; v._r.data.Oi[n] = e } e.Wr.code = v.oi; p.ii = []; p.Ei = ""; p.xi = ""; O(v._r) } }; p.Er = function () { t() }; p["delete"] = function () { var e = r.confirm().title(i.J("delete menu") + "?").textContent().Pn().ok(i.J("yes")).cancel(i.J("no")); r.show(e).then(function () { t(); alert("TODO") }, function () { }) }; p.qi = function (e, n) { var t = r.confirm().title(i.J("delete food") + "?").textContent(e.ii).Pn(e).ok(i.J("yes")).cancel(i.J("no")); r.show(t).then(function () { v._r.data.ni.splice(n, 1); v._r.data.Oi.splice(n, 1); O(v._r) }, function () { }) }; p.Wi = function () { r.show({ controller: p.ji, tn: "assets/partials/popup/printmenu.html", parent: angular.an(document.body), Pn: "", rn: true, fullscreen: p.$n, d: { _r: v._r, Pe: v.Pe, Ae: v.Ae, Zi: v.Zi, H: v.ei, i: v.i, $: v.$, T: v.T } }).then(function () { }, function () { }) }; p.ji = function (o, n, u, l) { o._r = u._r; o.Pe = u.Pe; o.Ae = u.Ae; o.Zi = u.Zi; o.H = u.H; o.i = u.i; o.Ue = new Date(new Date(o._r.Ue)).toLocaleDateString(); o.zi = u.$.Dn + " " + u.$.Jn; o.T = u.T; o.Aa == null; o.Ua = false; o.cancel = function () { n.cancel() }; o.Yi = 1; o.Hi = function (e) { if (e < 1 || m.un(e)) { return false } o.Yi = e; l({ url: g.i.L + "Foods.asmx/ChangeNumberOfConsumers", method: "POST", data: { ie: o._r.data.ni, number: e } }).then(function (e) { o.ie = JSON.parse(e.data.d) }, function (e) { alert(e.data.d) }) }; if (angular.M(o._r)) { o.Hi(o.Yi) } o.Ki = function (e) { return m.Ki(e) }; o._e = function (e) { return v._e(e) }; o.Qi = function (e) { var n = ""; if (e.Vi > 0) { n = servDes(n, e.Vi, "cereals_") } if (e.Xi > 0) { n = servDes(n, e.Xi, "vegetables_") } if (e.eo > 0) { n = servDes(n, e.eo, "fruit_") } if (e.no > 0) { n = servDes(n, e.no, "meat_") } if (e.to > 0) { n = servDes(n, e.to, "milk_") } if (e.ao > 0) { n = servDes(n, e.ao, "fats_") } return n }; function servDes(e, n, t) { return (m.un(e) ? "" : e + ", ") + n + " serv. " + i.J(t) } o.ro = function (e) { return e.includes("~") }; var a = null; o.list = []; var r = []; o.io = function (e) { if (r === e) { return r } if (!m.un(e) && !o.list.includes(e)) { o.list.push(e); var n = e.split("|"); var t = []; angular.forEach(n, function (e, n) { t.push({ title: e.split("~")[0], description: e.split("~")[1] }) }); a = e; r = t; return t.length > 0 ? t : e } else { r = e; return e } }; o.H = u.H; o.oo = function (a, r, i) { if (angular.M(v._r)) { o.Ua = true; l({ url: g.i.L + "Foods.asmx/ChangeNumberOfConsumers", method: "POST", data: { ie: v._r.data.ni, number: a } }).then(function (e) { var n = JSON.parse(e.data.d); var t = angular.pa(v._r); t.data.ni = n; l({ url: g.i.L + "PrintPdf.asmx/MenuPdf", method: "POST", data: { ae: g.ee, _r: t, Zi: v.Zi, Yi: a, lang: v.i.language, H: o.H, Ue: r, zi: i, Ba: u.$.Ba } }).then(function (e) { var n = e.data.d; o.Ua = false; o.Aa = g.i.L + "upload/users/" + v.$.Y + "/pdf/" + n + ".pdf" }, function (e) { o.Ua = false; alert(e.data.d) }) }, function (e) { alert(e.data.d) }) } }; o._a = function () { o.Aa = null }; o.uo = function (e) { o.zi = e }; o.setDate = function (e) { o.Ue = e }; o.send = function () { if (v._r.data.ni.length == 0) { return false } if (v.$.C == "demo") { m.gt("this function is not available in demo version"); return false } if (v.$.re < 1) { m.gt("this function is available only in standard and premium package"); return false } e() }; var e = function () { v.Ae.Pe = v.Pe; var e = o.Aa === undefined ? null : o.Aa; n.show({ controller: t, tn: "assets/partials/popup/sendmenu.html", parent: angular.an(document.body), rn: true, d: { _r: v._r, Ae: v.Ae, $: v.$, Aa: e } }).then(function (e) { }, function () { }) }; var t = function (n, t, a, e, r, i) { n.d = angular.pa(e); var o = function (e) { n.sn = null; n.cn = null; if (i.un(e._r.title)) { n.sn = r.J("menu title is required"); return false } if (i.un(e.Ae.email)) { n.cn = r.J("email is required"); return false } t.hide(); a({ url: g.i.L + "Mail.asmx/SendMenu", method: "POST", data: { email: e.Ae.email, _r: e._r, $: n.d.$, lang: v.i.language, Aa: n.d.Aa } }).then(function (e) { i.alert(e.data.d, "") }, function (e) { i.alert(r.J(e.data.d), "") }) }; n.cancel = function () { t.cancel() }; n.confirm = function (e) { o(e) } } }; p.get = function () { if (v.$.C == "demo") { m.gt("this function is not available in demo version") } else { l() } }; var l = function () { r.show({ controller: f, tn: "assets/partials/popup/getmenu.html", parent: angular.an(document.body), rn: true, data: { i: v.i, Pe: v.Pe } }).then(function (e) { v._r.id = e.id; v._r.title = e.title; v._r.note = e.note; v._r.ae = e.ae; v._r.data = e.data; v._r.Ae.Pe = v.Pe; v._r.Ae.Pe.Ie = e.data.Ie; v._r.Ae.Pe.Je = e.Ae.Pe.Je; v.Ce = false; if (v._r.Ae.Pe.Je != null) { if (v._r.Ae.Pe.Je.data != null) { if (v._r.Ae.Pe.Je.data.Ie.length >= 2) { v.Ce = true } } } n(angular.pa(v._r.Ae.Pe)); O(v._r); v.oi = e.data.Ie[0].code }, function () { }) }; var f = function (t, a, n, e, r, i, o) { t.i = e.i; t.Pe = e.Pe; t.lo = 0; t.type = 0; t.fo = false; t.so = false; t.co = ""; t.ta = 20; t["do"] = null; var u = v.i.mo; var l = 0; t.toggle = function (e) { if (e == "myMenus") { t.d = []; u = v.i.mo; l = 0; f(null) } else if (e == "appMenus") { d() } }; t.aa = function (e) { l += v.i.mo; f(e) }; t.d = []; var f = function (e) { t.te = true; t.fo = false; n({ url: g.i.L + "Menues.asmx/Load", method: "POST", data: { ae: v.$.Y, ta: u, offset: l, search: e } }).then(function (e) { var n = JSON.parse(e.data.d); angular.forEach(n, function (e, n) { e.Ue = new Date(e.Ue) }); t.d = t.d.concat(n); t.te = false }, function (e) { t.te = false; alert(e.data.d) }) }; f(null); t.search = function (e) { t.d = []; u = v.i.mo; l = 0; f(e) }; t.remove = function (e) { var n = a.confirm().title(r.J("remove menu") + "?").textContent(e.title).Pn(e).ok(r.J("yes")).cancel(r.J("no")); a.show(n).then(function () { s(e) }, function () { }) }; var s = function (e) { n({ url: g.i.L + "Menues.asmx/Delete", method: "POST", data: { ae: v.$.Y, id: e.id } }).then(function (e) { t.d = JSON.parse(e.data.d) }, function (e) { alert(e.data.d) }) }; t.cancel = function () { a.cancel() }; var c = function (e) { n({ url: g.i.L + "Menues.asmx/Get", method: "POST", data: { ae: v.$.Y, id: e.id } }).then(function (e) { var n = JSON.parse(e.data.d); a.hide(n) }, function (e) { alert(e.data.d) }) }; var d = function () { t.fo = true; n({ url: g.i.L + "Menues.asmx/LoadAppMenues", method: "POST", data: { lang: v.i.language } }).then(function (e) { t.d = JSON.parse(e.data.d) }, function (e) { alert(e.data.d) }) }; var m = function (e) { n({ url: g.i.L + "Menues.asmx/GetAppMenu", method: "POST", data: { id: e.id, lang: v.i.language, so: t.so } }).then(function (e) { var n = JSON.parse(e.data.d); if (t.so == true) { p(n) } a.hide(n) }, function (e) { alert(e.data.d) }) }; t.confirm = function (e) { t.fo == true ? m(e) : c(e) }; t.po = function (e) { t.so = e }; t.vo = function (e) { t.co = e }; var p = function (e) { v.B(t.co); o(function () { angular.forEach(e.data.ni, function (e, n) { e.ii = r.J(e.ii); e.Fi = r.J(e.Fi) }); angular.forEach(e.data.Oi, function (e, n) { e.ii = r.J(e.ii); e.Fi = r.J(e.Fi) }); a.hide(e); v.B("hr") }, 500) } }; p.save = function () { if (v._r.data.ni.length == 0) { return false } if (v.$.C == "demo") { m.gt("the saving function is disabled in demo version"); return false } else { s() } }; var s = function () { v.Ae.Pe = v.Pe; r.show({ controller: c, tn: "assets/partials/popup/savemenu.html", parent: angular.an(document.body), rn: true, d: { _r: v._r, Ae: v.Ae, Zi: v.Zi, i: g.i, $: v.$ } }).then(function (e) { v._r = e }, function () { }) }; var c = function (t, a, r, i, o) { t.d = angular.pa(i); var u = function (e) { if (m.un(e.title)) { document.getElementById("txtMenuTitle").focus(); m.alert(o.J("enter menu title"), ""); s(); return false } e.he = i.Ae.Pe.he.he; var n = null; if (e.data.Ie.length > 2) { if (e.data.Ie[0].code != "B") { n = t.d.Ae.Pe.Je } } e.Ue = m.Re(e.Ue); r({ url: g.i.L + "Menues.asmx/Save", method: "POST", data: { ae: v.$.Y, x: e, $: t.d.$, Je: n } }).then(function (e) { if (e.data.d != "error") { t.d._r = JSON.parse(e.data.d); a.hide(t.d._r) } else { m.alert(o.J("there is already a menu with the same name"), "") } }, function (e) { m.alert(o.J(e.data.d), "") }) }; t.cancel = function () { a.cancel() }; t.confirm = function (e, n) { e.Ae = i.Ae; e.ae = i.Ae.ae; e.id = n == true ? null : e.id; e.nr = i.Zi.nr; e.Ue = new Date((new Date).setHours(0, 0, 0, 0)); u(e) }; var n = function (e) { if (m.un(e.title)) { document.getElementById("txtMenuTitle").focus(); m.alert(o.J("enter menu title"), ""); s(); return false } e.he = i.Ae.Pe.he.he; r({ url: g.i.L + "Menues.asmx/SaveAppMenu", method: "POST", data: { x: e, lang: v.i.language } }).then(function (e) { m.alert("ok", "") }, function (e) { m.alert(o.J(e.data.d), "") }) }; t.ho = function (e) { e.nr = i.Zi.nr; n(e) } }; var O = function (e) { a({ url: g.i.L + S + "/GetTotals", method: "POST", data: { ni: e.data.ni, Ie: e.data.Ie } }).then(function (e) { v.Zi = JSON.parse(e.data.d); v.Zi.So.V = v.i.V; y() }, function (e) { alert(e.data.d) }) }; var y = function () { if (v.ri === undefined || v.Zi === undefined) { return false } p.Oo = []; p.yo = []; p.To = []; p.xo = []; angular.forEach(v._r.data.Ie, function (e, n) { if (e.De == true && angular.M(v.Zi)) { if (angular.M(v.Zi.wo)) { if (n < v.ri.bo.length) { p.Oo.push(v.Zi.wo.length > 0 ? v.Zi.wo[n].nr.Po.toFixed(1) : 0); if (v.ri !== undefined) { if (angular.M(v.ri.bo)) { p.yo.push(v.ri.bo[n].Wr.Yr); p.To.push(v.ri.bo[n].Wr.Hr) } } p.xo.push(i.J(v._e(e))) } } } }); T(); x(); w(); b(); $(); k(); I(); P(); var e = v.Zi; var n = v.ri; v.$o = h.wa([i.J("cereals"), i.J("vegetables"), i.J("fruit"), i.J("meat"), i.J("milk"), i.J("fats")], [[e.ko.Vi, e.ko.Xi, e.ko.eo, e.ko.no, e.ko.to, e.ko.ao], [n.ko.Vi, n.ko.Xi, n.ko.eo, n.ko.no, n.ko.to, n.ko.ao]], [i.J("cereals"), i.J("vegetables"), i.J("fruit"), i.J("meat"), i.J("milk"), i.J("fats")], ["#45b7cd", "#33cc33", "#33cc33"], { ba: true, Pa: true, $a: { display: true }, ka: { Ia: [{ display: true, Na: { display: false }, Ma: { Ca: true } }], Da: [{ display: true, Na: { display: false }, Ma: { Ca: true } }] } }, [{ label: i.J("choosen"), borderWidth: 1, type: "bar", fill: true }, { label: i.J("recommended"), borderWidth: 3, Io: "rgba(255,99,132,0.4)", No: "rgba(255,99,132,1)", type: "line", fill: true }]); v.Mo = h.wa([i.J("carbohydrates"), i.J("proteins"), i.J("fats")], [e.Co, e.Do, e.Jo], [i.J("carbohydrates") + " (%)", i.J("proteins") + " (%)", i.J("fats") + " (%)"], ["#45b7cd", "#ff6384", "#33cc33"], { ba: true, Pa: true, $a: { display: true }, ka: { Ia: [{ display: false, Na: { display: false }, Ma: { Ca: true } }], Da: [{ display: false, Na: { display: false }, Ma: { Ca: true } }] } }, []); var t = function (e) { return h.wa(p.xo, [p.Oo, p.yo, p.To], p.xo, ["#45b7cd", "#ff6384", "#33cc33"], { ba: true, Pa: true, $a: { display: e }, ka: { Ia: [{ display: true, Na: { display: true }, Ma: { Ca: true } }], Da: [{ display: true, Na: { display: true }, Ma: { Ca: true, Fo: 200 } }] } }, [{ label: i.J("choosen") + " (" + i.J("kcal") + ")", borderWidth: 1, type: "bar", fill: true }, { label: i.J("recommended") + " " + i.J("from") + " (" + i.J("kcal") + ")", borderWidth: 3, Io: "rgba(255,99,132,0.4)", No: "rgba(255,99,132,1)", type: "line", fill: false }, { label: i.J("recommended") + " " + i.J("to") + " (" + i.J("kcal") + ")", borderWidth: 3, Io: "rgba(255,99,132,0.4)", No: "rgba(255,99,132,1)", type: "line", fill: false }]) }; v.Go = t(false); v.Lo = t(true); p.Ao = h.Uo([i.J("choosen")], [[e.Ro, e.Bo, e._o, e.Eo, e.qo, e.Wo, e.jo]], [i.J("starch") + " (" + i.J("g") + ")", i.J("total sugar") + " (" + i.J("g") + ")", i.J("glucose") + " (" + i.J("g") + ")", i.J("fructose") + " (" + i.J("g") + ")", i.J("saccharose") + " (" + i.J("g") + ")", i.J("maltose") + " (" + i.J("g") + ")", i.J("lactose") + " (" + i.J("g") + ")"], ["#33cc33"], ""); p.Zo = h.Uo([i.J("choosen"), i.J("recommended dietary allowance") + " (" + i.J("rda").toUpperCase() + ")"], [[e.zo, e.Yo, e.Ho, e.Ko, e.Qo, e.Vo, e.Xo, e.eu, e.nu, e.tu, e.au, e.ru, e.iu, e.ou, e.uu, e.lu, e.fu, e.su, e.cu, e.du, e.mu, e.pu, e.gu, e.vu, e.hu], [n.zo.Su, n.Yo.Su, n.Ho.Su, n.Ko.Su, n.Qo.Su, n.Vo.Su, n.Xo.Su, n.eu.Su, n.nu.Su, n.tu.Su, n.au.Su, n.ru.Su, n.iu.Su, n.ou.Su, n.uu.Su, n.lu.Su, n.fu.Su, n.su.Su, n.cu.Su, n.du.Su, n.mu.Su, n.pu.Su, n.gu.Su, n.vu.Su, n.hu.Su]], [i.J("fibers") + " (" + i.J("g") + ")", i.J("monounsaturated fats") + " (" + i.J("g") + ")", i.J("polyunsaturated fats") + " (" + i.J("g") + ")", i.J("calcium") + " (" + i.J("mg") + ")", i.J("magnesium") + " (" + i.J("mg") + ")", i.J("phosphorus") + " (" + i.J("mg") + ")", i.J("iron") + " (" + i.J("mg") + ")", i.J("copper") + " (" + i.J("mg") + ")", i.J("zinc") + " (" + i.J("mg") + ")", i.J("manganese") + " (" + i.J("mg") + ")", i.J("selenium") + " (" + i.J("ug") + ")", i.J("iodine") + " (" + i.J("ug") + ")", i.J("retinol") + " (" + i.J("ug") + ")", i.J("vitamin D") + " (" + i.J("ug") + ")", i.J("vitamin E") + " (" + i.J("mg") + ")", i.J("vitamin B1") + " (" + i.J("mg") + ")", i.J("vitamin B2") + " (" + i.J("mg") + ")", i.J("vitamin B3") + " (" + i.J("mg") + ")", i.J("vitamin B6") + " (" + i.J("mg") + ")", i.J("vitamin B12") + " (" + i.J("ug") + ")", i.J("folate") + " (" + i.J("ug") + ")", i.J("pantothenic acid") + " (" + i.J("mg") + ")", i.J("biotin") + " (" + i.J("ug") + ")", i.J("vitamin C") + " (" + i.J("mg") + ")", i.J("vitamin K") + " (" + i.J("ug") + ")"], ["#45b7cd", "#33cc33"], i.J("parameters")); p.Ou = h.Uo([i.J("choosen"), i.J("upper intake level") + " (" + i.J("ul").toUpperCase() + ")"], [[e.yu, e.Tu, e.xu], [n.yu.wu, n.Tu.wu, n.xu.wu]], [i.J("saturated fats") + " (" + i.J("g") + ")", i.J("trifluoroacetic acid") + " (" + i.J("g") + ")", i.J("cholesterol") + " (" + i.J("mg") + ")"], ["#f44242", "#33cc33"], ""); p.bu = h.Uo([i.J("choosen"), i.J("upper intake level") + " (" + i.J("ul").toUpperCase() + ")", i.J("minimum dietary allowance") + " (" + i.J("mda").toUpperCase() + ")"], [[e.Pu, e.$u, e.ku], [n.Pu.wu], [n.Pu.Iu, n.$u.Iu, n.ku.Iu]], [i.J("sodium") + " (" + i.J("mg") + ")", i.J("potassium") + " (" + i.J("mg") + ")", i.J("chlorine") + " (" + i.J("mg") + ")"], ["#45b7cd", "#33cc33"], "") }; var T = function () { var e = parseInt(v.ri.nr); var n = "energyChart"; var t = v.Zi.nr.toFixed(0); var a = "kcal"; var r = { title: "energy", min: 0, max: e + e * .06, gr: e - e * .02, vr: e + e * .02, hr: e + e * .02, Sr: e + e * .04, Or: e + e * .04, yr: e + e * .06, Tr: 5 }; google.dr.load("current", { mr: ["gauge"] }); google.dr.xr(h.wr(n, t, a, r)); p.Nu = function () { if (t < e - e * .02) { return "fa fa-minus" } if (t >= e - e * .02 && t <= e + e * .04) { return "fa fa-check" } if (t > e + e * .04) { return "fa fa-exclamation" } } }; var x = function () { var e = v.ri.ko.Mu; var n = "otherFoodChart"; var t = v.Zi.ko.Mu.toFixed(0); var a = "kcal"; var r = { title: "energy", min: 0, max: e + e * .5, gr: 0, vr: e - e * .02, hr: e - e * .02, Sr: e, Or: e, yr: e + e * .5, Tr: 5 }; google.dr.load("current", { mr: ["gauge"] }); google.dr.xr(h.wr(n, t, a, r)); p.Cu = function () { return t < e ? "label label-success fa fa-check" : "label label-danger fa fa-exclamation" } }; var w = function () { var e = { from: v.ri.Du, Xa: v.ri.Ju }; var n = "carbohydratesChart"; var t = v.Zi.Co.toFixed(0); var a = "%"; var r = { title: "carbohidrates", min: 0, max: 100, gr: e.from, vr: e.Xa - e.Xa * .02, hr: e.Xa - e.Xa * .02, Sr: e.Xa, Or: e.Xa, yr: 100, Tr: 5 }; google.dr.load("current", { mr: ["gauge"] }); google.dr.xr(h.wr(n, t, a, r)); p.Fu = function () { if (t < e.from) { return "fa fa-minus" } if (t >= e.from && t <= e.Xa) { return "fa fa-check" } if (t > e.Xa) { return "fa fa-plus" } } }; var b = function () { var e = { from: v.ri.Gu, Xa: v.ri.Lu }; var n = "proteinsChart"; var t = v.Zi.Do.toFixed(0); var a = "%"; var r = { title: "proteins", min: 0, max: 100, gr: e.from, vr: e.Xa - e.Xa * .02, hr: e.Xa - e.Xa * .02, Sr: e.Xa, Or: e.Xa, yr: 100, Tr: 5 }; google.dr.load("current", { mr: ["gauge"] }); google.dr.xr(h.wr(n, t, a, r)); p.Au = function () { if (t < e.from) { return "fa fa-minus" } if (t >= e.from && t <= e.Xa) { return "fa fa-check" } if (t > e.Xa) { return "fa fa-plus" } } }; var P = function () { var e = { from: v.ri.Uu, Xa: v.ri.Ru }; var n = "fatsChart"; var t = v.Zi.Jo.toFixed(0); var a = "%"; var r = { title: "fats", min: 0, max: 100, gr: e.from, vr: e.Xa - e.Xa * .02, hr: e.Xa - e.Xa * .02, Sr: e.Xa, Or: e.Xa, yr: 100, Tr: 5 }; google.dr.load("current", { mr: ["gauge"] }); google.dr.xr(h.wr(n, t, a, r)); p.Bu = function () { if (t < e.from) { return "fa fa-minus" } if (t >= e.from && t <= e.Xa) { return "fa fa-check" } if (t > e.Xa) { return "fa fa-plus" } } }; var $ = function () { var e = "saturatedFatsChart"; var n = v.Zi.yu; unit = "mg"; var t = { title: "saturated fats", min: 0, max: Math.round(v.ri.yu.wu + v.ri.yu.wu * .4), gr: 0, vr: v.ri.yu.wu - v.ri.yu.wu * .2, hr: v.ri.yu.wu - v.ri.yu.wu * .2, Sr: v.ri.yu.wu, Or: v.ri.yu.wu, yr: v.ri.yu.wu + v.ri.yu.wu * .4, Tr: 5 }; h.wr(e, n, unit, t) }; var k = function () { var e = "trifluoroaceticAcidChart"; var n = v.Zi.Tu; unit = "mg"; var t = { title: "trifluoroacetic acid", min: 0, max: Math.round(v.ri.Tu.wu + v.ri.Tu.wu * .4), gr: 0, vr: v.ri.Tu.wu - v.ri.Tu.wu * .2, hr: v.ri.Tu.wu - v.ri.Tu.wu * .2, Sr: v.ri.Tu.wu, Or: v.ri.Tu.wu, yr: v.ri.Tu.wu + v.ri.Tu.wu * .4, Tr: 5 }; h.wr(e, n, unit, t) }; var I = function () { var e = "cholesterolChart"; var n = v.Zi.xu; unit = "mg"; var t = { title: "cholesterol", min: 0, max: Math.round(v.ri.xu.wu + v.ri.xu.wu * .4), gr: 0, vr: v.ri.xu.wu - v.ri.xu.wu * .2, hr: v.ri.xu.wu - v.ri.xu.wu * .2, Sr: v.ri.xu.wu, Or: v.ri.xu.wu, yr: v.ri.xu.wu + v.ri.xu.wu * .4, Tr: 5 }; h.wr(e, n, unit, t) }; var N = function (e) { var n = v.ri.nr; var t = "mealEnergyChart_" + e; var a = angular.M(v.Zi) ? v.Zi.wo[e].nr.Po : 0; p._u = a; var r = "Energija"; var i = 0; var o = n + n * .2; var u = n - n * .02; var l = n + n * .02; var f = n + n * .02; var s = n + n * .04; var c = n + n * .04; var d = o; var m = 5; google.dr.load("current", { mr: ["gauge"] }); google.dr.xr(h.wr(t, a, r, i, o, u, l, f, s, c, d, m)) }; p.Eu = function (t) { var a = t; if (t > 0) { angular.forEach(v._r.data.ni, function (e, n) { if (e.Wr.code == v.oi) { if (n < t) { a = n + 1 } } }); var e = v._r.data.ni[a - 1]; v._r.data.ni[a - 1] = v._r.data.ni[t]; v._r.data.ni[t] = e; var n = v._r.data.Oi[a - 1]; v._r.data.Oi[a - 1] = v._r.data.Oi[t]; v._r.data.Oi[t] = n } }; p.qu = function (t) { var a = t; if (t < v._r.data.ni.length - 1) { var r = true; angular.forEach(v._r.data.ni, function (e, n) { if (e.Wr.code == v.oi && r == true) { if (n > t && n > 0) { a = n - 1; r = false } } }); var e = v._r.data.ni[a + 1]; v._r.data.ni[a + 1] = v._r.data.ni[t]; v._r.data.ni[t] = e; var n = v._r.data.Oi[a + 1]; v._r.data.Oi[a + 1] = v._r.data.Oi[t]; v._r.data.Oi[t] = n } }; p.Wu = function (e) { if (e.Wr.code == v.oi) { return true } else { return false } }; p.ju = function (e, n) { if (!angular.M(e) || !angular.M(n)) { return false } if (n.Iu != null) { if (e < n.Iu) { return "background-color:#9bc1ff; color:white" } } if (n.wu != null) { if (e > n.wu) { return "background-color:#f94040; color:white" } } }; p.Zu = function () { M() }; var M = function () { if (v.$.C == "demo") { m.gt("this function is not available in demo version"); return false } r.show({ controller: C, tn: "assets/partials/popup/getrecipe.html", parent: angular.an(document.body), rn: true, Pe: v.Pe, i: v.i }).then(function (a) { angular.forEach(a.data.ni, function (e, n) { var t = v._r.data.ni.length; p.Ii(e, a.data.Oi[n], t) }); O(v._r) }, function () { }) }; var C = function (t, a, r, e, n, i, o, u) { t.Pe = e; t.i = n; t.$ = v.$; t.lo = 0; t.type = 0; t.zu = false; t.so = false; t.co = ""; t.Yu = true; t.ta = 20; t.aa = function () { t.ta += 20 }; var l = function () { if (v.$.C == "demo") { return false } t.te = true; t.zu = false; r({ url: g.i.L + "Recipes.asmx/Load", method: "POST", data: { ae: v.$.Y } }).then(function (e) { t.zu = false; t.d = JSON.parse(e.data.d); t.te = false }, function (e) { t.te = false; alert(e.data.d) }) }; l(); var f = function () { if (v.$.C == "demo") { return false } r({ url: g.i.L + "Recipes.asmx/Init", method: "POST", data: "" }).then(function (e) { t.Hu = JSON.parse(e.data.d) }, function (e) { alert(e.data.d) }) }; f(); t.load = function () { l() }; t.cancel = function () { a.cancel() }; t.Ku = function () { a.cancel(); v.Ne = "./assets/partials/myrecipes.html"; v.Me = "myrecipes" }; t.get = function (e) { s(e) }; var s = function (e, n) { r({ url: g.i.L + "Recipes.asmx/Get", method: "POST", data: { ae: v.$.Y, id: e.id } }).then(function (e) { t.Hu = JSON.parse(e.data.d); if (n == true) { angular.forEach(v._r.data.Ie, function (e, n) { if (e.code == v.oi) { e.description = e.description == "" ? t.Hu.title + ".\n" + t.Hu.description : e.description + "\n" + t.Hu.title + ".\n" + t.Hu.description } }) } a.hide(t.Hu) }, function (e) { alert(e.data.d) }) }; t.Qu = function () { t.zu = true; r({ url: g.i.L + "Recipes.asmx/LoadAppRecipes", method: "POST", data: { lang: v.i.language } }).then(function (e) { t.d = JSON.parse(e.data.d) }, function (e) { alert(e.data.d) }) }; var c = function (e, n) { r({ url: g.i.L + "Recipes.asmx/GetAppRecipe", method: "POST", data: { id: e.id, lang: v.i.language, so: t.so } }).then(function (e) { t.Hu = JSON.parse(e.data.d); if (n == true) { angular.forEach(v._r.data.Ie, function (e, n) { if (e.code == v.oi) { e.description = e.description == "" ? t.Hu.description : e.description + "\n" + t.Hu.description } }) } a.hide(t.Hu) }, function (e) { alert(e.data.d) }) }; t.confirm = function (e, n) { t.zu == true ? c(e, n) : s(e, n) }; t.po = function (e) { t.so = e }; t.vo = function (e) { t.co = e }; var d = function (e) { v.B(t.co); u(function () { angular.forEach(e.data.ni, function (e, n) { e.ii = i.J(e.ii); e.Fi = i.J(e.Fi) }); angular.forEach(e.data.Oi, function (e, n) { e.ii = i.J(e.ii); e.Fi = i.J(e.Fi) }); a.hide(e); v.B("hr") }, 500) } }; var D = function (e) { a({ url: g.i.L + "WeeklyMenus.asmx/GetWeeklyMenusTotals", method: "POST", data: { ae: g.ee, ci: e } }).then(function (e) { v.Zi = JSON.parse(e.data.d); v.Zi.So.V = v.i.V; y() }, function (e) { alert(e.data.d) }) }; p.Vu = function (e) { return D(e) }; p.Xu = function (e) { p.te = true; d(function () { p.te = false; v.si = e; if (e == "dailyMenuTpl") { O(v._r) } }, 700) }; if (v.si !== "weeklyMenuTpl") { v.si = "dailyMenuTpl" } var J = function () { if (v._r.data.ni.length == 0) { m.alert(i.J("menu is empty") + "!", ""); return false } p.el = true; if (angular.M(v._r)) { var e = angular.pa(v._r); a({ url: g.i.L + "PrintPdf.asmx/MenuDetailsPdf", method: "POST", data: { ae: g.ee, _r: e, zt: v.zt, Zi: v.Zi, ri: v.ri, lang: v.i.language, Ba: v.$.Ba } }).then(function (e) { var n = e.data.d; p.el = false; p.Aa = g.i.L + "upload/users/" + v.$.Y + "/pdf/" + n + ".pdf" }, function (e) { p.el = false; alert(e.data.d) }) } }; var F = function () { p.el = true; if (angular.M(v._r)) { var e = angular.pa(v._r); e.title = v.di.title; e.note = v.di.note; e.he = v.di.he.he; a({ url: g.i.L + "PrintPdf.asmx/MenuDetailsPdf", method: "POST", data: { ae: g.ee, _r: e, zt: v.zt, Zi: v.Zi, ri: v.ri, lang: v.i.language, Ba: v.$.Ba } }).then(function (e) { var n = e.data.d; p.el = false; p.Aa = g.i.L + "upload/users/" + v.$.Y + "/pdf/" + n + ".pdf" }, function (e) { p.el = false; alert(e.data.d) }) } }; p.Aa == null; p.el = false; p.nl = function () { if (v.si == "dailyMenuTpl") { J() } else { F() } }; p._a = function () { p.Aa = null }; p.tl = function (e, n) { if (e.ni.length == 0) { return false } v.Ne = "./assets/partials/myrecipes.html"; v.Me = "myrecipes"; v.al = e; v.rl = n }; p.il = function (t) { var a = null; angular.forEach(v.Zi.wo, function (e, n) { if (e.code == t) { a = e } }); return a }; p.ol = function (t) { var a = null; angular.forEach(v.ri.bo, function (e, n) { if (e.Wr.code == t) { a = e.Wr } }); return a }; p.ul = function (e) { p.ll = e }; p.ul("parametersChartTpl"); p.fl = function (e, n, t) { var a = "pull-right fa fa-"; if (e > t) { return a + "chevron-circle-right text-danger" } else if (e < n) { return a + "chevron-circle-left text-info" } else { return a + "check-circle text-success" } }; p.sl = function (e, n) { var t = "pull-right fa fa-"; if (e / n - 1 > .05) { return t + "chevron-circle-right text-danger" } else if (e / n - 1 < -.05) { return t + "chevron-circle-left text-info" } else { return t + "check-circle text-success" } }; p.cl = function (e, n) { var t = "pull-right fa fa-"; if (e - n > 1) { return t + "chevron-circle-right text-danger" } else if (e - n < -1) { return t + "chevron-circle-left text-info" } else { return t + "check-circle text-success" } }; p.dl = function (e, n) { var t = "pull-right fa fa-"; if (e > n) { return t + "chevron-circle-right text-danger" } else { return t + "check-circle text-success" } }; p.ml = []; p.pl = function (e) { if (v.$.C == "demo") { m.gt("this function is not available in demo version"); return false } if (v.$.re < 2 || v.$.C == "demo") { m.gt("this function is available only in premium package"); return false } G(e) }; var G = function (e) { if (v._r.data.ni.length == 0) { return false } r.show({ controller: L, tn: "assets/partials/popup/shoppinglist.html", parent: angular.an(document.body), rn: true, d: { _r: e, H: v.ei } }).then(function (e) { alert(e) }, function () { }) }; var L = function (a, r, e, i, n, t, o) { a._r = n._r; a.H = n.H; a.Yi = 1; a.Aa == null; a.Ua = false; var u = function (e, n) { i({ url: g.i.L + "ShoppingList.asmx/Create", method: "POST", data: { x: e, Yi: n, lang: r.i.language } }).then(function (e) { a.d = JSON.parse(e.data.d); if (a.d.total) { if (a.d.total.So > 0) { a.H.gl = true } } }, function (e) { m.alert(t.J(e.data.d), "") }) }; u(a._r.data.ni, a.Yi); a.Hi = function (e) { if (e < 1 || m.un(e)) { return false } u(a._r.data.ni, e) }; a.Ki = function (e) { return m.Ki(e) }; a.vl = function (e, n, t) { a.Ua = true; if (angular.M(a._r)) { i({ url: g.i.L + "PrintPdf.asmx/ShoppingList", method: "POST", data: { ae: g.ee, ml: e, _r: a._r, Yi: n, lang: r.i.language, H: t, Ba: r.$.Ba } }).then(function (e) { var n = e.data.d; a.Ua = false; a.Aa = g.i.L + "upload/users/" + r.$.Y + "/pdf/" + n + ".pdf" }, function (e) { a.Ua = false; alert(e.data.d) }) } }; a._a = function () { a.Aa = null }; a.cancel = function () { e.cancel() } }; p.hl = function () { openPrintPdfPopup() } }]).controller("myFoodsCtrl", ["$scope", "$http", "$sessionStorage", "$window", "$rootScope", "$mdDialog", "functions", "$translate", function (t, n, o, e, u, a, l, f) { var s = "MyFoods.asmx"; t.Fi = null; var r = function () { n({ url: o.i.L + "Foods.asmx/Init", method: "POST", data: { lang: u.i.language } }).then(function (e) { var n = JSON.parse(e.data.d); if (u.ki !== undefined) { if (u.ki != null) { t.Sl = u.ki; u.ki = null } else { t.Sl = n.ii } } else { t.Sl = n.ii } t.units = n.units; t.Ol = n.ue; $(".selectpicker").yl({ style: "btn-default", size: 4 }) }, function (e) { alert(e.data.d) }) }; r(); t.Er = function () { r() }; t.remove = function (e) { var n = a.confirm().title(f.J("delete food") + "?").textContent(e.ii).Pn(e).ok(f.J("yes")).cancel(f.J("no")); a.show(n).then(function () { i(e) }, function () { }) }; var i = function (e) { n({ url: o.i.L + s + "/Delete", method: "POST", data: { ae: u.$.Y, id: e.id } }).then(function (e) { u.ne(); r() }, function (e) { l.alert(f.J(e.data.d), "") }) }; var c = function () { n({ url: o.i.L + s + "/Load", method: "POST", data: { ae: o.ee } }).then(function (e) { var n = JSON.parse(e.data.d); u.oe = n.ie }, function (e) { l.alert(f.J(e.data.d), "") }) }; t.save = function (e) { if (u.$.C == "demo") { l.gt("this function is not available in demo version"); return false } if (l.un(e.ii)) { l.alert(f.J("food title is required"), ""); return false } e.Fi = t.Fi; if (d(e) == true) { e.ko.Vi = 0; e.ko.Xi = 0; e.ko.eo = 0; e.ko.no = 0; e.ko.to = 0; e.ko.ao = 0; e.ko.Tl = 1; e.ko.Mu = e.nr; e.Gi.code = "OF" } n({ url: o.i.L + s + "/Save", method: "POST", data: { ae: u.$.Y, x: e } }).then(function (e) { if (e.data.d != "there is already a food with the same name") { l.alert(f.J(e.data.d), ""); u.ne() } else { l.alert(f.J("there is already a food with the same name"), "") } }, function (e) { l.alert(f.J(e.data.d), "") }) }; var d = function (e) { if (e.ko.Vi > 0 || e.ko.Xi > 0 || e.ko.eo > 0 || e.ko.no > 0 || e.ko.to > 0 || e.ko.ao > 0) { e.ko.Tl = 0; e.ko.Mu = 0; return false } else { return true } }; t.search = function () { m() }; var m = function () { if (u.$.C == "demo") { return false } a.show({ controller: p, tn: "assets/partials/popup/myfoods.html", parent: angular.an(document.body), rn: true }).then(function (e) { t.Sl = e }, function () { }) }; var p = function (t, a, n) { t.ta = 20; t.aa = function () { t.ta += 20 }; var e = function () { t.te = true; n({ url: o.i.L + "MyFoods.asmx/Load", method: "POST", data: { ae: o.ee } }).then(function (e) { var n = JSON.parse(e.data.d); t.d = n.ie; t.te = false }, function (e) { t.te = false; alert(e.data.d) }) }; e(); t.cancel = function () { a.cancel() }; var r = function (e) { n({ url: o.i.L + "MyFoods.asmx/Get", method: "POST", data: { ae: u.$.Y, id: e.id } }).then(function (e) { var n = JSON.parse(e.data.d); a.hide(n) }, function (e) { alert(e.data.d) }) }; t.confirm = function (e) { r(e) }; t.remove = function (e) { var n = a.confirm().title(f.J("delete food") + "?").textContent(e.ii).Pn(e).ok(f.J("yes")).cancel(f.J("no")); a.show(n).then(function () { i(e); m() }, function () { m() }) }; var i = function (e) { n({ url: o.i.L + s + "/Delete", method: "POST", data: { ae: u.$.Y, id: e.id } }).then(function (e) { u.ne() }, function (e) { l.alert(f.J(e.data.d), "") }) } } }]).controller("myRecipesCtrl", ["$scope", "$http", "$sessionStorage", "$window", "$rootScope", "$mdDialog", "functions", "$translate", function (t, n, f, e, u, a, l, s) { var c = "Recipes.asmx"; t.Vr = "fa fa-plus"; t.Xr = false; var r = function () { n({ url: f.i.L + "Recipes.asmx/Init", method: "POST", data: "" }).then(function (e) { t.Hu = JSON.parse(e.data.d); t.xl = null; u.Zi = null; o(); i() }, function (e) { alert(e.data.d) }) }; var i = function () { if (u.$.C == "demo") { return false } u.te = true; n({ url: f.i.L + "Recipes.asmx/Load", method: "POST", data: { ae: f.ee } }).then(function (e) { t.wl = JSON.parse(e.data.d); u.te = false }, function (e) { u.te = false; alert(e.data.d) }) }; var o = function () { if (angular.M(u.al)) { if (u.al != null) { if (angular.M(u.al.ni)) { angular.forEach(u.al.ni, function (e, n) { if (e.Wr.code == u.rl) { t.Hu.data.ni.push(e); t.Hu.data.Oi.push(u.al.ni[n]) } }); angular.forEach(u.al.Ie, function (e, n) { if (e.code == u.rl) { t.Hu.description = e.description } }) } } } }; r(); t.add = function (e) { t.Hu.push(e) }; t.wi = function (e, n) { t.Xr = true; t.Vr = "fa fa-spinner fa-spin"; a.show({ controller: u.bi, tn: "assets/partials/popup/food.html", parent: angular.an(document.body), rn: true, d: { ie: u.ie, oe: u.oe, ue: u.ue, ii: e, Pi: n, i: u.i } }).then(function (e) { t.ii = e; if (n == null) { t.Hu.data.ni.push(e.ii); t.Hu.data.Oi.push(e.Si) } else { t.Hu.data.ni[n] = e.ii; t.Hu.data.Oi[n] = e.Si } h(t.Hu); t.Vr = "fa fa-plus"; t.Xr = false }, function () { t.Vr = "fa fa-plus"; t.Xr = false }) }; t.Er = function () { u.al = null; r() }; t.get = function (e) { if (e == null) { return false } n({ url: f.i.L + "Recipes.asmx/Get", method: "POST", data: { ae: f.ee, id: e } }).then(function (e) { t.Hu = JSON.parse(e.data.d); h(t.Hu) }, function (e) { alert(e.data.d) }) }; t.save = function (e) { if (u.$.C == "demo") { l.gt("the saving function is disabled in demo version"); return false } if (e.title == "" || e.title == null) { l.alert(s.J("enter recipe title"), ""); return false } if (e.data.ni.length == 0) { l.alert(s.J("choose food"), ""); return false } n({ url: f.i.L + "Recipes.asmx/Save", method: "POST", data: { ae: f.ee, x: e } }).then(function (e) { if (e.data.d != "there is already a recipe with the same name") { t.Hu = JSON.parse(e.data.d); i() } else { l.alert(s.J("there is already a recipe with the same name"), "") } }, function (e) { alert(e.data.d) }) }; t.qi = function (e) { var n = a.confirm().title(s.J("delete food") + "?").textContent().Pn().ok(s.J("yes")).cancel(s.J("no")); a.show(n).then(function () { t.Hu.data.ni.splice(e, 1); t.Hu.data.Oi.splice(e, 1); h(t.Hu) }, function () { }) }; t.remove = function (e) { var n = a.confirm().title(s.J("delete recipe") + "?").textContent().Pn().ok(s.J("yes")).cancel(s.J("no")); a.show(n).then(function () { d(e) }, function () { }) }; var d = function (e) { n({ url: f.i.L + c + "/Delete", method: "POST", data: { ae: u.$.Y, id: e.id } }).then(function (e) { r() }, function (e) { alert(e.data.d) }) }; t.search = function () { m() }; var m = function () { if (u.$.C == "demo") { return false } a.show({ controller: p, tn: "assets/partials/popup/myrecipes.html", parent: angular.an(document.body), rn: true }).then(function (e) { t.Hu = e; h(t.Hu) }, function () { }) }; var p = function (n, t, a) { n.ta = 20; n.aa = function () { n.ta += 20 }; var e = function () { if (u.$.C == "demo") { return false } n.te = true; a({ url: f.i.L + "Recipes.asmx/Load", method: "POST", data: { ae: u.$.Y } }).then(function (e) { n.d = JSON.parse(e.data.d); n.te = false }, function (e) { n.te = false; alert(e.data.d) }) }; e(); var r = function () { if (u.$.C == "demo") { return false } a({ url: f.i.L + "Recipes.asmx/Init", method: "POST", data: "" }).then(function (e) { n.Hu = JSON.parse(e.data.d) }, function (e) { alert(e.data.d) }) }; r(); n.cancel = function () { t.cancel() }; var i = function (e) { a({ url: f.i.L + "Recipes.asmx/Get", method: "POST", data: { ae: u.$.Y, id: e.id } }).then(function (e) { n.Hu = JSON.parse(e.data.d); t.hide(n.Hu) }, function (e) { alert(e.data.d) }) }; n.confirm = function (e) { i(e) }; n.remove = function (e) { var n = t.confirm().title(s.J("delete recipe") + "?").textContent(e.title).Pn(e).ok(s.J("yes")).cancel(s.J("no")); t.show(n).then(function () { o(e); m() }, function () { m() }) }; var o = function (e) { a({ url: f.i.L + c + "/Delete", method: "POST", data: { ae: u.$.Y, id: e.id } }).then(function (e) { r() }, function (e) { alert(e.data.d) }) } }; t.bl = function (e) { if (e.data.ni.length == 0) { l.alert(s.J("choose food"), ""); return false } g(e) }; var g = function (e) { a.show({ controller: v, tn: "assets/partials/popup/saverecipeasmyfood.html", parent: angular.an(document.body), rn: true, data: e }).then(function (e) { t.Hu = e }, function () { }) }; var v = function (t, a, e, n, r, i) { t.d = { Hu: n, units: [], Fi: null, Pl: false, $l: false }; var o = function () { e({ url: f.i.L + "Foods.asmx/Init", method: "POST", data: { lang: i.i.language } }).then(function (e) { var n = JSON.parse(e.data.d); t.d.units = n.units }, function (e) { alert(e.data.d) }) }; o(); t.cancel = function () { a.cancel() }; t.confirm = function (e) { if (i.$.C == "demo") { r.gt("the saving function is disabled in demo version"); return false } if (r.un(e.Hu.title)) { t.d.Pl = true } else if (r.un(e.Fi)) { t.d.$l = true } else { u(e) } }; var u = function (n) { e({ url: f.i.L + "Recipes.asmx/SaveAsFood", method: "POST", data: { ae: i.$.Y, Hu: n.Hu, Fi: n.Fi } }).then(function (e) { i.ne(); a.hide(n.Hu); r.alert(s.J(e.data.d), "") }, function (e) { r.alert(s.J(e.data.d), "") }) }; var l = function () { e({ url: f.i.L + "MyFoods.asmx/Load", method: "POST", data: { ae: i.$.Y } }).then(function (e) { var n = JSON.parse(e.data.d); i.oe = n.ie }, function (e) { r.alert(s.J(e.data.d), "") }) } }; t.kl = function (e) { if (u.$.re < 2 || u.$.C == "demo") { l.gt("this function is available only in premium package"); return false } a.show({ controller: t.Il, tn: "assets/partials/popup/printrecipe.html", parent: angular.an(document.body), Pn: "", rn: true, fullscreen: t.$n, d: { Hu: e, Zi: t.Zi, H: u.ei, i: u.i, $: u.$ } }).then(function () { }, function () { }) }; t.Il = function (r, e, i, o) { r.Hu = i.Hu; r.Zi = i.Zi; r.H = i.H; r.i = i.i; r.zi = i.$.Dn + " " + i.$.Jn; r.Ue = new Date(new Date).toLocaleDateString(); r.cancel = function () { e.cancel() }; r.Yi = 1; r.Hi = function (e) { if (e < 1 || l.un(e)) { return false } r.Yi = e; o({ url: f.i.L + "Foods.asmx/ChangeNumberOfConsumers", method: "POST", data: { ie: r.Hu.data.Oi, number: e } }).then(function (e) { r.Hu.data.ni = JSON.parse(e.data.d) }, function (e) { alert(e.data.d) }) }; if (angular.M(r.Hu)) { r.Hi(r.Yi) } r.Ki = function (e) { return l.Ki(e) }; r.Qi = function (e) { var n = ""; if (e.Vi > 0) { n = servDes(n, e.Vi, "cereals_") } if (e.Xi > 0) { n = servDes(n, e.Xi, "vegetables_") } if (e.eo > 0) { n = servDes(n, e.eo, "fruit_") } if (e.no > 0) { n = servDes(n, e.no, "meat_") } if (e.to > 0) { n = servDes(n, e.to, "milk_") } if (e.ao > 0) { n = servDes(n, e.ao, "fats_") } return n }; function servDes(e, n, t) { return (l.un(e) ? "" : e + ", ") + n + " serv. " + s.J(t) } r.Aa == null; r.Ua = false; r.Nl = function (n, t, a) { if (angular.M(r.Hu)) { r.Ua = true; o({ url: f.i.L + "Foods.asmx/ChangeNumberOfConsumers", method: "POST", data: { ie: r.Hu.data.Oi, number: n } }).then(function (e) { o({ url: f.i.L + "PrintPdf.asmx/RecipePdf", method: "POST", data: { ae: f.ee, Hu: r.Hu, Zi: r.Zi, Yi: n, lang: u.i.language, H: r.H, Ue: t, zi: a, Ba: i.$.Ba } }).then(function (e) { var n = e.data.d; r.Ua = false; r.Aa = f.i.L + "upload/users/" + u.$.Y + "/pdf/" + n + ".pdf" }, function (e) { r.Ua = false; alert(e.data.d) }) }, function (e) { alert(e.data.d) }) } }; r._a = function () { r.Aa = null }; r.uo = function (e) { r.zi = e }; r.setDate = function (e) { r.Ue = e } }; var h = function (e) { n({ url: f.i.L + "Foods.asmx/GetTotals", method: "POST", data: { ni: e.data.ni, Ie: null } }).then(function (e) { t.Zi = JSON.parse(e.data.d); t.Zi.So.V = u.i.V }, function (e) { alert(e.data.d) }) } }]).controller("pricesCtrl", ["$scope", "$http", "$sessionStorage", "$rootScope", "$translate", "functions", "$mdDialog", function (t, n, a, r, i, o, u) { var l = "Prices.asmx"; t.Ml = 0; t.Cl = function (e) { t.Dl = e == 0 ? r.ie : r.oe }; t.Cl(t.Ml); var e = function () { n({ url: a.i.L + l + "/Init", method: "POST", data: "" }).then(function (e) { t.So = JSON.parse(e.data.d); t.So.Jl.V = a.i.V; f() }, function (e) { o.alert(i.J(e.data.d), "") }) }; e(); var f = function () { n({ url: a.i.L + l + "/Load", method: "POST", data: { ae: r.$.Y } }).then(function (e) { t.Fl = JSON.parse(e.data.d) }, function (e) { o.alert(i.J(e.data.d), "") }) }; t.Gl = function (e) { var n = JSON.parse(e); t.So.ii.id = n.id; t.So.ii.title = n.ii; t.Ll(e) }; t.Ll = function (e) { if (angular.Al(e)) { e.Ul.value = e.Jl.value * (1 / e.gi.value) * 1e3 } }; t.save = function (e) { if (e.ii.title == null) { return false } if (r.$.C == "demo") { o.gt("this function is not available in demo version"); return false } n({ url: a.i.L + l + "/Save", method: "POST", data: { ae: r.$.Y, x: e } }).then(function (e) { f(); o.alert(i.J(e.data.d), "") }, function (e) { o.alert(i.J(e.data.d), "") }) }; t.remove = function (e) { var n = u.confirm().title(i.J("delete input") + "?").textContent().Pn().ok(i.J("yes")).cancel(i.J("no")); u.show(n).then(function () { s(e) }, function () { }) }; var s = function (e) { n({ url: a.i.L + l + "/Delete", method: "POST", data: { ae: r.$.Y, x: e } }).then(function (e) { f() }, function (e) { o.alert(i.J(e.data.d), "") }) } }]).controller("orderCtrl", ["$scope", "$http", "$rootScope", "$translate", "functions", function (a, t, r, i, n) { a.Rl = i.J("nutrition program"); a.version = "STANDARD"; a.re = 1; a.kn = false; a.Bl = "fa fa-angle-double-right"; a._l = i.J("send order"); a.El = r.$.yn != "" ? false : true; a.ql = false; a.Wl = false; a.hn = function (e, n) { t({ url: r.i.L + "Users.asmx/Login", method: "POST", data: { yn: e, password: n } }).then(function (e) { var n = JSON.parse(e.data.d); if (n.ae != null) { a.$.Dn = n.Dn; a.$.Jn = n.Jn; a.$.xt = n.xt; a.$.wt = n.wt; a.$.bt = n.bt; a.$.Pt = n.Pt; a.$.$t = n.$t; a.$.kt = n.kt; a.$.email = n.email; a.$.re = n.re; a.El = true; a.ql = false; a.jl() } else { a.ql = true; a.Sn = i.J("wrong user name or password") } }, function (e) { a.On = true; a.ql = true; a.Sn = i.J("user was not found"); a.El = false }) }; var o = function () { t({ url: r.i.L + "Orders.asmx/Init", method: "POST", data: "" }).then(function (e) { a.$ = JSON.parse(e.data.d); a.$.yn = r.$.yn; a.$.password = r.$.password; a.$.Rl = a.Rl; a.$.version = a.version; a.$.Zl = 1; a.$.zl = 1; a.$.re = a.re; a.hn(a.$.yn, a.$.password) }, function (e) { alert(e.data.d) }) }; var e = function () { t.get("./config/config.json").then(function (e) { r.i = e.data; o() }) }; a.Yl = function (e) { a.re = e }; var u = function () { a.Hl = []; for (var e = 5; e < 101; e++) { a.Hl.push(e) } }; u(); a.Kl = 5; a.Ql = function (e) { a.Kl = e; a.jl() }; a.jl = function () { var e = 0; var n = 0; a.$.version = a.version; if (a.$.re == 0) { e = r.i.mr[0].So; a.$.version = r.i.mr[0].title } if (a.$.re == 1) { e = r.i.mr[1].So; a.$.version = r.i.mr[1].title } if (a.$.re == 2) { e = r.i.mr[2].So; a.$.version = r.i.mr[2].title } if (a.$.Zl > 1) { e = e * a.$.Zl - e * a.$.Zl * (a.$.Zl / 10) } a.$.zl = 1; n = a.$.zl > 1 ? e * a.$.zl - e * a.$.zl * .1 : e; var t = a.Kl > 5 && a.$.re == 2 ? (a.Kl - 5) * 50 : 0; a.$.So = n + t; a.$.Vl = (n + t) / r.i.Xl }; if (r.i == undefined) { e() } else { o() } a.order = function (e, n) { o(); window.location.hash = "orderform"; a.$.Rl = e; a.$.version = n; a.jl() }; a.ef = function (e) { a.$.Rl = e; a.jl() }; a.nf = function (e) { a.ql = false; if (e.email == "" || e.Dn == "" || e.Jn == "" || e.wt == "" || e.bt == "" || e.Pt == "" || e.$t == "") { a.ql = true; a.Sn = i.J("all fields are required"); return false } if (a.re == 1) { if (e.xt == "" || e.kt == "") { a.ql = true; a.Sn = i.J("all fields are required"); return false } } a.Bl = "fa fa-spinner fa-spin"; a._l = i.J("sending"); a.tf = true; t({ url: r.i.L + "Orders.asmx/SendOrder", method: "POST", data: { x: e, lang: r.i.language } }).then(function (e) { if (e.data.d == "error") { a.kn = false; a.Wl = false; a.Bl = "fa fa-paper-plane-o"; a._l = i.J("send"); a.tf = false; n.alert(i.J("order is not sent"), "") } else { a.kn = true; a.Wl = true } }, function (e) { a.kn = false; a.Wl = false; a.Bl = "fa fa-paper-plane-o"; a.tf = false; a._l = i.J("send"); alert(e.data.d) }) }; a.af = function () { window.location.hash = "registration" }; a.rf = function () { if (r.$.C == "expired") { r.Te = "./assets/partials/login.html" } else { r.Te = "./assets/partials/dashboard.html" } } }]).controller("infoCtrl", ["$scope", "$rootScope", "$translate", function (e, n, t) { }]).controller("settingsCtrl", ["$scope", "$http", "$rootScope", "$translate", "$sessionStorage", "functions", function (e, t, a, r, i, o) { var u = "Files.asmx"; if (angular.M(i.H)) { a.H = i.H } e.save = function (n) { if (a.$.C == "demo") { o.gt("the saving function is disabled in demo version"); return false } t({ url: i.i.L + u + "/SaveJsonToFile", method: "POST", data: { Z: "users/" + a.$.Y, filename: "settings", json: JSON.stringify(n) } }).then(function (e) { a.i.language = n.language; a.i.V = n.V; o.alert(r.J("settings saved successfully"), "") }, function (e) { o.alert(r.J(e.data.d), "") }) } }]).controller("weeklyMenuCtrl", ["$scope", "$http", "$sessionStorage", "$window", "$rootScope", "$mdDialog", "functions", "$translate", function (r, i, g, e, v, t, o, u) { var n = "WeeklyMenus.asmx"; r.Yi = 1; r.Ue = new Date(new Date(v._r.Ue)).toLocaleDateString(); r.zi = v.$.Dn + " " + v.$.Jn; r.getDay = function (e) { switch (e) { case 0: return u.J("monday"); case 1: return u.J("tuesday"); case 2: return u.J("wednesday"); case 3: return u.J("thursday"); case 4: return u.J("friday"); case 5: return u.J("saturday"); case 6: return u.J("sunday"); default: return "" } }; var f = true; var a = function (e) { f = true; angular.forEach(e, function (e, n) { if (!o.un(e)) { f = false; return false } }) }; r["if"] = function () { a(r.di.ci); return f }; var l = function () { r.te = true; i({ url: g.i.L + n + "/Init", method: "POST", data: { $: v.$, Ae: v.Ae, lang: v.i.language } }).then(function (e) { v.di = JSON.parse(e.data.d); r.te = false }, function (e) { r.te = false; alert(e.data.d) }) }; if (!angular.M(v.di)) { l() } r.Er = function () { l() }; r.uf = function () { window.print() }; r.Aa = null; r.Ua = false; r.lf = function () { if (r.Aa != null) { window.open(r.Aa, window.innerWidth <= 800 && window.innerHeight <= 600 ? "_self" : "_blank") } }; r.get = function (e) { if (v.$.C == "demo") { o.gt("this function is not available in demo version") } else { s(e) } }; var s = function (n) { t.show({ controller: c, tn: "assets/partials/popup/getmenu.html", parent: angular.an(document.body), rn: true, data: { i: v.i, Pe: v.Pe } }).then(function (e) { r.di.ci[n] = e.id; r.di.ff[n].title = e.title; r.di.ff[n].he = u.J(e.he); r.di.ff[n].nr = e.nr }, function () { }) }; var c = function (t, a, n, e, r, i, o) { t.i = e.i; t.Pe = e.Pe; t.lo = 0; t.type = 0; t.fo = false; t.so = false; t.co = ""; t.ta = 20; t["do"] = null; var u = v.i.mo; var l = 0; t.toggle = function (e) { if (e == "myMenus") { t.d = []; u = v.i.mo; l = 0; f(null) } else if (e == "appMenus") { d() } }; t.aa = function (e) { l += v.i.mo; f(e) }; t.d = []; var f = function (e) { t.te = true; t.fo = false; n({ url: g.i.L + "Menues.asmx/Load", method: "POST", data: { ae: v.$.Y, ta: u, offset: l, search: e } }).then(function (e) { var n = JSON.parse(e.data.d); angular.forEach(n, function (e, n) { e.Ue = new Date(e.Ue) }); t.d = t.d.concat(n); t.te = false }, function (e) { t.te = false; alert(e.data.d) }) }; f(null); t.search = function (e) { t.d = []; u = v.i.mo; l = 0; f(e) }; t.remove = function (e) { var n = a.confirm().title(r.J("remove menu") + "?").textContent(e.title).Pn(e).ok(r.J("yes")).cancel(r.J("no")); a.show(n).then(function () { s(e) }, function () { }) }; var s = function (e) { n({ url: g.i.L + "Menues.asmx/Delete", method: "POST", data: { ae: v.$.Y, id: e.id } }).then(function (e) { t.d = JSON.parse(e.data.d) }, function (e) { alert(e.data.d) }) }; t.cancel = function () { a.cancel() }; var c = function (e) { n({ url: g.i.L + "Menues.asmx/Get", method: "POST", data: { ae: v.$.Y, id: e.id } }).then(function (e) { var n = JSON.parse(e.data.d); a.hide(n) }, function (e) { alert(e.data.d) }) }; var d = function () { t.fo = true; n({ url: g.i.L + "Menues.asmx/LoadAppMenues", method: "POST", data: { lang: v.i.language } }).then(function (e) { t.d = JSON.parse(e.data.d) }, function (e) { alert(e.data.d) }) }; var m = function (e) { n({ url: g.i.L + "Menues.asmx/GetAppMenu", method: "POST", data: { id: e.id, lang: v.i.language, so: t.so } }).then(function (e) { var n = JSON.parse(e.data.d); if (t.so == true) { p(n) } a.hide(n) }, function (e) { alert(e.data.d) }) }; t.confirm = function (e) { t.fo == true ? m(e) : c(e) }; t.po = function (e) { t.so = e }; t.vo = function (e) { t.co = e }; var p = function (e) { v.B(t.co); o(function () { angular.forEach(e.data.ni, function (e, n) { e.ii = r.J(e.ii); e.Fi = r.J(e.Fi) }); angular.forEach(e.data.Oi, function (e, n) { e.ii = r.J(e.ii); e.Fi = r.J(e.Fi) }); a.hide(e); v.B("hr") }, 500) } }; r.Ua = false; r.sf = ["A4", "A3", "A2", "A1"]; v.ei.cf = "A3"; v.ei.df = false; v.ei.Yu = false; v.ei.orientation = "L"; r.mf = function (e, n, t, a) { if (f) { o.alert(u.J("select menus"), ""); return false } r.Aa = null; r.Ua = true; i({ url: g.i.L + "PrintPdf.asmx/WeeklyMenuPdf", method: "POST", data: { ae: g.ee, di: v.di, Yi: e, lang: v.i.language, H: n, Ue: t, zi: a, Ba: v.$.Ba } }).then(function (e) { var n = e.data.d; r.Aa = g.i.L + "upload/users/" + v.$.Y + "/pdf/" + n + ".pdf"; r.Ua = false }, function (e) { r.Ua = false; alert(e.data.d) }) }; r._a = function () { r.Aa = null }; r.search = function () { d() }; var d = function () { t.show({ controller: m, tn: "assets/partials/popup/searchweeklymenus.html", parent: angular.an(document.body), rn: true, d: {} }).then(function (e) { v.di = e; v.di.Ae = v.Ae; v.di.he = v.Pe.he }, function () { }) }; var m = function (n, t, a, r, i) { var o = "WeeklyMenus.asmx"; n.type = 0; n.ta = 20; n.aa = function () { n.ta += 20 }; var e = function () { n.te = true; a({ url: g.i.L + o + "/Load", method: "POST", data: { ae: v.$.Y, lang: v.i.language } }).then(function (e) { n.d = JSON.parse(e.data.d); n.te = false }, function (e) { n.te = false; i.alert(e.data.d, "") }) }; e(); n.load = function () { e() }; n.remove = function (e) { if (f) return false; var n = t.confirm().title(r.J("remove menu") + "?").textContent(e.title).Pn(e).ok(r.J("yes")).cancel(r.J("no")); t.show(n).then(function () { u(e) }, function () { }) }; var u = function (e) { a({ url: g.i.L + o + "/Delete", method: "POST", data: { ae: v.$.Y, id: e.id, lang: v.i.language } }).then(function (e) { n.d = JSON.parse(e.data.d) }, function (e) { alert(e.data.d) }) }; n.cancel = function () { t.cancel() }; var l = function (e) { a({ url: g.i.L + o + "/Get", method: "POST", data: { ae: v.$.Y, id: e.id, lang: v.i.language } }).then(function (e) { var n = JSON.parse(e.data.d); t.hide(n) }, function (e) { alert(e.data.d) }) }; n.cancel = function () { t.cancel() }; n.confirm = function (e) { l(e) } }; r.save = function () { if (f) { o.alert(u.J("select menus"), ""); return false } p() }; var p = function () { t.show({ controller: h, tn: "assets/partials/popup/saveweeklymenu.html", parent: angular.an(document.body), rn: true, d: { di: v.di } }).then(function (e) { v.di = e }, function () { }) }; var h = function (n, t, e, a, r, i) { var o = "WeeklyMenus.asmx"; n.d = e.di; var u = function (e) { if (v.$.C == "demo") { i.gt("the saving function is disabled in demo version"); return false } if (i.un(e.title)) { i.alert(r.J("enter menu title"), ""); return false } a({ url: g.i.L + o + "/Save", method: "POST", data: { ae: v.$.Y, x: n.d } }).then(function (e) { if (e.data.d != "error") { n.d = JSON.parse(e.data.d); t.hide(n.d) } else { i.alert(r.J("there is already a menu with the same name"), "") } }, function (e) { i.alert(r.J(e.data.d), "") }) }; n.cancel = function () { t.cancel() }; n.confirm = function (e, n) { e.id = n == true ? null : e.id; e.Ue = new Date((new Date).setHours(0, 0, 0, 0)); u(e) }; n.cancel = function () { t.cancel() }; var l = function (e) { a({ url: g.i.L + o + "/Get", method: "POST", data: { ae: v.$.Y, id: e.id } }).then(function (e) { n.d = JSON.parse(e.data.d); t.hide(n.d) }, function (e) { alert(e.data.d) }) }; n.cancel = function () { t.cancel() } }; r.remove = function (e) { if (f) { return false } var n = t.confirm().title(u.J("remove menu") + "?").textContent(e.title).Pn(e).ok(u.J("yes")).cancel(u.J("no")); t.show(n).then(function () { S(e) }, function () { }) }; var S = function (e) { i({ url: g.i.L + n + "/Delete", method: "POST", data: { ae: v.$.Y, id: e.id, lang: v.i.language } }).then(function (e) { r.d = JSON.parse(e.data.d) }, function (e) { alert(e.data.d) }) }; r.send = function () { O() }; var O = function () { if (f) { o.alert(u.J("select menus"), ""); return false } if (r.Aa == null) { return false } t.show({ controller: y, tn: "assets/partials/popup/sendweeklymenu.html", parent: angular.an(document.body), rn: true, d: { Ae: v.Ae, $: v.$, Aa: r.Aa } }).then(function (e) { }, function () { }) }; var y = function (e, n, t, a, r, i) { e.d = angular.pa(a); e.pf = { title: "", note: "" }; var o = function () { e.sn = null; e.cn = null; if (i.un(e.pf.title)) { e.sn = r.J("menu title is required"); return false } if (i.un(e.d.Ae.email)) { e.cn = r.J("email is required"); return false } n.hide(); t({ url: g.i.L + "Mail.asmx/SendWeeklyMenu", method: "POST", data: { email: e.d.Ae.email, $: e.d.$, Aa: e.d.Aa, title: e.pf.title, note: e.pf.note, lang: v.i.language } }).then(function (e) { i.alert(e.data.d, "") }, function (e) { i.alert(r.J(e.data.d), "") }) }; e.cancel = function () { n.cancel() }; e.confirm = function () { o() } }; r.gf = null; r.vf = false; r.hf = function (e, t, a) { i({ url: g.i.L + "ShoppingList.asmx/CreateWeeklyShoppingList", method: "POST", data: { ae: g.ee, ci: e, Yi: t, lang: v.i.language } }).then(function (e) { var n = JSON.parse(e.data.d); if (n.total) { if (n.total.So > 0) { r.ei.gl = true } } T(n, t, a) }, function (e) { o.alert(u.J(e.data.d), "") }) }; var T = function (e, n, t) { r.vf = true; if (angular.M(r._r)) { i({ url: g.i.L + "PrintPdf.asmx/WeeklyMenuShoppingList", method: "POST", data: { ae: g.ee, ml: e, Yi: n, lang: v.i.language, H: t, Ba: v.$.Ba } }).then(function (e) { var n = e.data.d; r.vf = false; r.gf = g.i.L + "upload/users/" + v.$.Y + "/pdf/" + n + ".pdf" }, function (e) { r.vf = false; alert(e.data.d) }) } }; r.Sf = function () { r.gf = null }; r.uo = function (e) { r.zi = e }; r.setDate = function (e) { r.Ue = e } }]).controller("clientAppCtrl", ["$scope", "$http", "$sessionStorage", "$window", "$rootScope", "$mdDialog", "functions", "$translate", "$timeout", function (r, i, o, e, u, n, l, f, t) { var a = "ClientApp.asmx"; r.show = false; r.df = f.J("show access data"); r.toggle = function (e, n) { r.show = !r.show; if (r.show == true) { if (n.id == null) { r.Of(e, n) } r.df = f.J("hide access data") } else { r.df = f.J("show access data") } }; r.get = function (e) { r.Ae = e; r.show = false; r.df = f.J("show access data"); i({ url: o.i.L + a + "/Get", method: "POST", data: { be: e.be } }).then(function (e) { r.yf = JSON.parse(e.data.d) }, function (e) { alert(e.data.d) }) }; r.Ae = null; r.Of = function (e, n) { if (n.id == null) { n.be = e.be; n.ae = u.$.Y; n.lang = u.i.language } i({ url: o.i.L + a + "/GetActivationCode", method: "POST", data: { x: n } }).then(function (e) { r.yf = JSON.parse(e.data.d) }, function (e) { alert(e.data.d) }) }; r.Tf = function (e) { if (e !== undefined) { return u.i.xf + "?uid=" + u.$.Y + "&cid=" + e.be + "&lang=" + u.i.language } else { return } }; r.wf = false; r.bf = function (e) { if (r.wf == true) { return false } if (l.un(e.email)) { l.alert(f.J("email is required"), ""); return false } r.wf = true; var n = r.Tf(e); var t = f.J("nutrition program") + ". " + f.J("application access data"); var a = "<p>" + f.J("dear") + "," + "</p>" + f.J("we send you the access data to track your body weight and download menus") + "." + "<br />" + "<br />" + f.J("web application") + ": " + '<strong><a href="' + u.i.xf + '">' + u.i.xf + "</a></strong>" + "<br />" + f.J("or") + " " + f.J("android application") + ": " + "<strong>" + '<a href="' + u.i.Pf + '">' + u.i.Pf + "</a></strong>" + "<br />" + '<iframe src="https://www.appsgeyser.com/social_widget/social_widget.php?width=100&height=100&apkName=Program Prehrane Klijent_8297899&simpleVersion=yes" width="180" height="220" vspace="0" hspace="0" frameborder="no" scrolling="no" seamless="" allowtransparency="true"></iframe>' + "<br />" + f.J("activation code") + ": " + "<strong>" + r.yf.code + "</strong>" + "<br />" + "<hr />" + f.J("or") + " " + f.J("web application") + " (" + f.J("without activation code") + "): " + '<strong><a href="' + n + '">' + n + "</a></strong>" + "<br />" + "<br />" + "<i>* " + f.J("this is an automatically generated email – please do not reply to it") + "</i>" + "<br />" + "<p>" + f.J("best regards") + "</p>" + '<a href="' + u.i.$f + '">' + u.i.kf + "</a>"; i({ url: o.i.L + "Mail.asmx/SendMessage", method: "POST", data: { dn: e.email, mn: t, pn: a, lang: u.i.language, gn: false } }).then(function (e) { r.wf = false; r.Ae = null; r.show = false; l.alert(e.data.d, "") }, function (e) { r.wf = false; l.alert(f.J(e.data.d), "") }) }; r.If = function (e) { u.Te = "./assets/partials/" + e + ".html" }; r.rf = function () { u.Te = "./assets/partials/dashboard.html" } }]).t("allowOnlyNumbers", function () { return { Nf: "A", link: function (e, n, t, a) { n.qn("keydown", function (e) { var n = $(this); var t = n.Po(); t = t.replace(",", "."); n.Po(t); if (e.which == 64 || e.which == 16) { return false } else if (e.which >= 48 && e.which <= 57) { return true } else if (e.which >= 96 && e.which <= 105) { return true } else if ([8, 13, 27, 37, 38, 39, 40].indexOf(e.which) > -1) { return true } else if (e.which == 110 || e.which == 188 || e.which == 190) { return true } else if (e.which == 46) { return true } else { e.preventDefault(); return false } }) } } }).t("customPopover", function () { return { Nf: "A", Mf: '<span><i class="fa fa-info-circle text-info" style="cursor:pointer"></i> {{label}}</span>', link: function (e, n, t) { e.label = t.Cf; $(n).Df({ Jf: "click", Ff: true, content: t.Gf, Lf: t.Af }) } } }).t("jsonDirective", function () { return { Nf: "E", scope: { data: "=", Uf: "=" }, tn: "./assets/partials/directive/json.html", controller: "jsonCtrl" } }).controller("jsonCtrl", ["$scope", "$rootScope", function (e, n) { e.Rf = false; e.debug = n.i.debug; e.show = function () { e.Rf = !e.Rf } }]);