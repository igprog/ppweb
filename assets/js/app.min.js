/*!
app.js
(c) 2017 IG PROG, www.igprog.hr
*/
angular.module("app", ["ngMaterial"]).controller("appCtrl", ["$scope", "$http", "$rootScope", function (e, n, o) { n.get("./config/config.json").then(function (e) { o.config = e.data }), e.pp5lang = "hr", e.setDownloadLink = function (n) { "hr" == n && (e.pp5downloadlink = "./download/" + n + "/ProgramPrehrane5.exe"), "rs" == n && (e.pp5downloadlink = "./download/" + n + "/ProgramPrehrane5S.exe") }, e.setDownloadLink(e.pp5lang); var a = new Date; e.year = a.getFullYear(), e.sendicon = "fa fa-angle-double-right", e.sendicontitle = "Dalje", e.hashId = function (e) { window.location.hash = e }, e.href = function (e) { window.open(e, "_blank") }, e.today = new Date, e.send = function (a) { e.sendicon = "fa fa-spinner fa-spin", e.sendicontitle = "Šaljem", n({ url: o.config.backend + "Mail.asmx/Send", method: "POST", data: { name: a.name, email: a.email, phone: a.phone, address: a.address, type: a.type, message: a.message } }).then(function (n) { e.sendicon = "fa fa-check", e.sendicontitle = "Poslano" }, function (n) { e.sendicon = "fa fa-exclamation-triangle", e.sendicontitle = "Greška.", alert(n.data.d) }) } }]).controller("webAppCtrl", ["$scope", "$http", "$rootScope", function (e, n, o) { o.application = "Program Prehrane", o.version = "WEB" }]).controller("pp5Ctrl", ["$scope", "$http", "$rootScope", function (e, n, o) { o.application = "Program Prehrane 5.0", o.version = "PREMIUM", e.gotoForm = function () { e.showUserDetails = !0 } }]).controller("singupCtrl", ["$scope", "$http", "$rootScope", function (e, n, o) { var a = function () { n({ url: o.config.backend + "Users.asmx/Init", method: "POST", data: "" }).then(function (n) { e.user = JSON.parse(n.data.d) }, function (e) { alert(e.data.d) }) }; void 0 == o.config ? n.get("./config/config.json").then(function (e) { o.config = e.data, a() }) : a(), e.singup = function (e) { e.userName = e.email, n({ url: o.config.backend + "Users.asmx/Singup", method: "POST", data: { x: e } }).then(function (e) { alert(e.data.d) }, function (e) { alert(e.data.d) }) } }]).controller("orderCtrl", ["$scope", "$http", "$rootScope", function (e, n, o) { e.application = o.application, e.version = o.version, e.userType = 0, e.showAlert = !1, e.sendicon = "fa fa-angle-double-right", e.sendicontitle = "Dalje", e.showUserDetails = !1, e.showErrorAlert = !1, e.showPaymentDetails = !1; var a = function () { n({ url: o.config.backend + "Orders.asmx/Init", method: "POST", data: "" }).then(function (n) { e.user = JSON.parse(n.data.d), e.user.application = e.application, e.user.version = "PREMIUM", e.user.licence = "0", e.user.licenceNumber = "1", e.calculatePrice() }, function (e) { alert(e.data.d) }) }; void 0 == o.config ? n.get("./config/config.json").then(function (e) { o.config = e.data, a() }) : a(), e.changeUserType = function (n) { e.userType = n }, e.calculatePrice = function () { var n = 0, a = 0; "Program Prehrane" == e.user.application ? (e.user.version = e.version, n = 550, e.user.licence = "1", e.user.licenceNumber = "1") : (e.user.version = "" == e.user.version ? "PREMIUM" : e.user.version, "START" == e.user.version && (n = "1" == e.user.licence ? 350 : 650), "PREMIUM" == e.user.version && (n = "1" == e.user.licence ? 550 : 950)), a = e.user.licenceNumber > 1 ? n * e.user.licenceNumber - n * e.user.licenceNumber * .1 : n, e.user.price = a, e.user.priceEur = a / o.config.eur }, e.order = function (n, o) { a(), window.location.hash = "order", e.user.application = n, e.user.version = o, e.calculatePrice() }, e.setApplication = function (n) { e.user.application = n, e.calculatePrice() }, e.sendOrder = function (a) { return e.showErrorAlert = !1, "" == a.email || "" == a.firstName || "" == a.lastName || "" == a.address || "" == a.postalCode || "" == a.city || "" == a.country ? (e.showErrorAlert = !0, e.errorMesage = "Sva polja su obavezna.", !1) : 1 != e.userType || "" != a.companyName && "" != a.pin ? (e.sendicon = "fa fa-spinner fa-spin", e.sendicontitle = "Šaljem", e.isSendButtonDisabled = !0, void n({ url: o.config.backend + "Orders.asmx/SendOrder", method: "POST", data: { x: a } }).then(function (n) { e.showAlert = !0, e.showPaymentDetails = !0, window.location.hash = "orderform" }, function (n) { e.showAlert = !1, e.showPaymentDetails = !1, e.sendicon = "fa fa-paper-plane-o", e.sendicontitle = "Pošalji", alert(n.data.d) })) : (e.showErrorAlert = !0, e.errorMesage = "Sva polja su obavezna.", !1) }, e.login = function (a, r) { n({ url: o.config.backend + "Users.asmx/Login", method: "POST", data: { userName: a, password: r } }).then(function (n) { var o = JSON.parse(n.data.d); o.userName == a ? (e.user.firstName = o.firstName, e.user.lastName = o.lastName, e.user.companyName = o.companyName, e.user.address = o.address, e.user.postalCode = o.postalCode, e.user.city = o.city, e.user.country = o.country, e.user.pin = o.pin, e.user.email = o.email, e.showUserDetails = !0, e.showErrorAlert = !1) : (e.showErrorAlert = !0, e.errorMesage = "Korisnik nije pronađen.") }, function (n) { e.errorLogin = !0, e.showErrorAlert = !0, e.errorMesage = "Korisnik nije pronađen.", e.showUserDetails = !1 }) }, e.registration = function () { window.location.hash = "registration" }, e.gotoForm = function () { e.showUserDetails = !0 } }]).controller("contactCtrl", ["$scope", "$http", "$rootScope", function (e, n, o) { e.showAlert = !1, e.sendicon = "fa fa-paper-plane-o", e.sendicontitle = "Pošalji", e.d = { name: "", email: "", message: "" }, e.send = function (a) { void 0 == o.config.backend && o.getConfig(), e.isSendButtonDisabled = !0, e.sendicon = "fa fa-spinner fa-spin", e.sendicontitle = "Šaljem", n({ url: o.config.backend + "Mail.asmx/Send", method: "POST", data: { name: a.name, email: a.email, messageSubject: "Program Prehrane - Upit", message: a.message } }).then(function (n) { e.showAlert = !0, e.sendicon = "fa fa-paper-plane-o", e.sendicontitle = "Pošalji", window.location.hash = "contact" }, function (n) { e.showAlert = !1, e.sendicon = "fa fa-paper-plane-o", e.sendicontitle = "Pošalji", alert(n.data.d) }) } }]);