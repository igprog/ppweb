/*!
app.min.js
(c) 2017 IG PROG, www.igprog.hr
*/
angular.module("app",["ngMaterial"]).controller("appCtrl",["$scope","$http","$rootScope",function(n,t,o){(function(){t.get("./config/config.json").then(function(n){o.config=n.data})})(),n.pp5lang="hr",n.setDownloadLink=function(t){"hr"==t&&(n.pp5downloadlink="./download/"+t+"/ProgramPrehrane5.exe"),"rs"==t&&(n.pp5downloadlink="./download/"+t+"/ProgramPrehrane5S.exe")},n.setDownloadLink(n.pp5lang);var e=new Date;n.year=e.getFullYear(),n.sendicon="fa fa-angle-double-right",n.sendicontitle="Dalje",n.hashId=function(n){window.location.hash=n},n.href=function(n){window.open(n,"_blank")},n.today=new Date,n.send=function(e){n.sendicon="fa fa-spinner fa-spin",n.sendicontitle="Šaljem",t({url:o.config.backend+"Mail.asmx/Send",method:"POST",data:{name:e.name,email:e.email,phone:e.phone,address:e.address,type:e.type,message:e.message}}).then(function(t){n.sendicon="fa fa-check",n.sendicontitle="Poslano"},function(t){n.sendicon="fa fa-exclamation-triangle",n.sendicontitle="Greška.",alert(t.data.d)})}}]).controller("webAppCtrl",["$scope","$http","$rootScope",function(n,t,o){o.application="Program Prehrane",o.version="WEB"}]).controller("pp5Ctrl",["$scope","$http","$rootScope",function(n,t,o){o.application="Program Prehrane 5.0",o.version="PREMIUM",n.gotoForm=function(){n.showUserDetails=!0}}]).controller("singupCtrl",["$scope","$http","$rootScope",function(n,t,o){var e=function(){t({url:o.config.backend+"Users.asmx/Init",method:"POST",data:""}).then(function(t){n.user=JSON.parse(t.data.d)},function(n){alert(n.data.d)})},a=function(){t.get("./config/config.json").then(function(n){o.config=n.data,e()})};void 0==o.config?a():e(),n.singup=function(n){n.userName=n.email,t({url:o.config.backend+"Users.asmx/Singup",method:"POST",data:{x:n}}).then(function(n){alert(n.data.d)},function(n){alert(n.data.d)})}}]).controller("orderCtrl",["$scope","$http","$rootScope",function(n,t,o){n.application=o.application,n.version=o.version,n.userType="0",n.showAlert=!1,n.sendicon="fa fa-angle-double-right",n.sendicontitle="Dalje",n.showUserDetails=!1,n.showErrorAlert=!1,n.showPaymentDetails=!1;var e=function(){t({url:o.config.backend+"Orders.asmx/Init",method:"POST",data:""}).then(function(t){n.user=JSON.parse(t.data.d),n.user.application=n.application,n.user.version="PREMIUM",n.user.licence="0",n.user.licenceNumber="1",n.calculatePrice()},function(n){alert(n.data.d)})},a=function(){t.get("./config/config.json").then(function(n){o.config=n.data,e()})};void 0==o.config?a():e(),n.calculatePrice=function(){var t=0,e=0;"Program Prehrane"==n.user.application?(n.user.version=n.version,t=550,n.user.licence="1",n.user.licenceNumber="1"):(n.user.version=""==n.user.version?"PREMIUM":n.user.version,"START"==n.user.version&&(t="1"==n.user.licence?350:650),"PREMIUM"==n.user.version&&(t="1"==n.user.licence?550:950)),e=n.user.licenceNumber>1?t*n.user.licenceNumber-t*n.user.licenceNumber*.1:t,n.user.price=e,n.user.priceEur=e/o.config.eur},n.order=function(t,o){e(),window.location.hash="order",n.user.application=t,n.user.version=o,n.calculatePrice()},n.setApplication=function(t){n.user.application=t,n.calculatePrice()},n.sendOrder=function(e){n.sendicon="fa fa-spinner fa-spin",n.sendicontitle="Šaljem",n.isSendButtonDisabled=!0,t({url:o.config.backend+"Orders.asmx/SendOrder",method:"POST",data:{x:e}}).then(function(t){n.showAlert=!0,n.showPaymentDetails=!0,window.location.hash="orderform"},function(t){n.showAlert=!1,n.showPaymentDetails=!1,n.sendicon="fa fa-paper-plane-o",n.sendicontitle="Pošalji",alert(t.data.d)})},n.login=function(e,a){t({url:o.config.backend+"Users.asmx/Login",method:"POST",data:{userName:e,password:a}}).then(function(t){var o=JSON.parse(t.data.d);o.userName==e?(n.user.firstName=o.firstName,n.user.lastName=o.lastName,n.user.companyName=o.companyName,n.user.address=o.address,n.user.postalCode=o.postalCode,n.user.city=o.city,n.user.country=o.country,n.user.pin=o.pin,n.user.email=o.email,n.showUserDetails=!0,n.showErrorAlert=!1):(n.showErrorAlert=!0,n.errorMesage="Korisnik nije pronađen.")},function(t){n.errorLogin=!0,n.showErrorAlert=!0,n.errorMesage="Korisnik nije pronađen.",n.showUserDetails=!1})},n.registration=function(){window.location.hash="registration"},n.gotoForm=function(){n.showUserDetails=!0}}]).controller("contactCtrl",["$scope","$http","$rootScope",function(n,t,o){n.showAlert=!1,n.sendicon="fa fa-paper-plane-o",n.sendicontitle="Pošalji",n.d={name:"",email:"",message:""},n.send=function(e){void 0==o.config.backend&&o.getConfig(),n.isSendButtonDisabled=!0,n.sendicon="fa fa-spinner fa-spin",n.sendicontitle="Šaljem",t({url:o.config.backend+"Mail.asmx/Send",method:"POST",data:{name:e.name,email:e.email,messageSubject:"Program Prehrane - Upit",message:e.message}}).then(function(t){n.showAlert=!0,n.sendicon="fa fa-paper-plane-o",n.sendicontitle="Pošalji",window.location.hash="contact"},function(t){n.showAlert=!1,n.sendicon="fa fa-paper-plane-o",n.sendicontitle="Pošalji",alert(t.data.d)})}}]);