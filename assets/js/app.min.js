/*!
app.js
(c) 2018 IG PROG, www.igprog.hr
*/
angular.module("app", ["ngMaterial"]).controller("appCtrl", ["$scope", "$http", "$rootScope", function (e, n, a) { n.get("./config/config.json").then(function (e) { a.config = e.data }), e.pp5lang = "hr", e.setDownloadLink = function (n) { "hr" == n && (e.pp5downloadlink = "./download/" + n + "/ProgramPrehrane5.exe"), "rs" == n && (e.pp5downloadlink = "./download/" + n + "/ProgramPrehrane5S.exe") }, e.setDownloadLink(e.pp5lang); var o = new Date; e.year = o.getFullYear(), e.sendicon = "fa fa-angle-double-right", e.sendicontitle = "Dalje", e.hashId = function (e) { window.location.hash = e }, e.href = function (e) { window.open(e, "_blank") }, e.today = new Date, e.send = function (o) { e.sendicon = "fa fa-spinner fa-spin", e.sendicontitle = "Šaljem", n({ url: a.config.backend + "Mail.asmx/Send", method: "POST", data: { name: o.name, email: o.email, phone: o.phone, address: o.address, type: o.type, message: o.message } }).then(function (n) { e.sendicon = "fa fa-check", e.sendicontitle = "Poslano" }, function (n) { e.sendicon = "fa fa-exclamation-triangle", e.sendicontitle = "Greška.", alert(n.data.d) }) } }]).controller("webAppCtrl", ["$scope", "$http", "$rootScope", function (e, n, a) { a.application = "Program Prehrane Web", a.version = "STANDARD" }]).controller("pp5Ctrl", ["$scope", "$http", "$rootScope", function (e, n, a) { a.application = "Program Prehrane 5.0", a.version = "PREMIUM", e.gotoForm = function () { e.showUserDetails = !0 } }]).controller("signupCtrl", ["$scope", "$http", "$rootScope", function (e, n, a) { e.accept = !1, e.msg = { title: null, css: null, icon: null }, e.hidebutton = !1, e.signupok = !1; var o = function () { n({ url: a.config.backend + "Users.asmx/Init", method: "POST", data: "" }).then(function (n) { e.user = JSON.parse(n.data.d), e.passwordConfirm = "", e.emailConfirm = "" }, function (e) { alert(e.data.d) }) }; null == a.config ? n.get("./config/config.json").then(function (e) { a.config = e.data, o() }) : o(), e.signup = function (o) { return e.msg = { title: null, css: null, icon: null }, o.userName = o.email, "" == o.firstName || "" == o.lastName || "" == o.email || "" == o.password || "" == e.passwordConfirm || "" == e.emailConfirm ? (e.msg.title = "Sva polja su obavezna.", e.msg.css = "danger", e.msg.icon = "exclamation", !1) : o.email != e.emailConfirm ? (e.msg.title = "Email adrese moraju biti jednake.", e.msg.css = "danger", e.msg.icon = "exclamation", !1) : o.password != e.passwordConfirm ? (e.msg.title = "Lozinke moraju biti jednake.", e.msg.css = "danger", e.msg.icon = "exclamation", !1) : 0 == e.accept ? (e.msg.title = "Morate prihvatiti uvjete korištenja.", e.msg.css = "danger", e.msg.icon = "exclamation", !1) : (e.hidebutton = !0, e.signupok = !1, void n({ url: a.config.backend + "Users.asmx/Signup", method: "POST", data: { x: o } }).then(function (n) { "the email address you have entered is already registered" == n.data.d && (e.msg.title = "E-mail adresa koju ste upisali je već registriran", e.msg.css = "danger", e.msg.icon = "exclamation", e.hidebutton = !1, e.signupok = !1), "registration completed successfully" == n.data.d && (e.msg.title = "Registracija upješno završena", e.msg.css = "success", e.msg.icon = "check", e.hidebutton = !0, e.signupok = !0) }, function (n) { alert(n.data.d), e.hidebutton = !1, e.signupok = !1 })) } }]).controller("orderCtrl", ["$scope", "$http", "$rootScope", function (e, n, a) { e.application = a.application, e.version = a.version, e.userType = 1, e.showAlert = !1, e.sendicon = "fa fa-angle-double-right", e.sendicontitle = "Dalje", e.showUserDetails = !1, e.showErrorAlert = !1, e.showPaymentDetails = !1; var o = function () { n({ url: a.config.backend + "Orders.asmx/Init", method: "POST", data: "" }).then(function (n) { e.user = JSON.parse(n.data.d), e.user.application = e.application, e.user.version = "Program Prehrane" == a.application ? "PREMIUM" : "STANDARD", e.user.licence = 1, e.user.licenceNumber = 1, e.user.userType = e.userType, e.calculatePrice() }, function (e) { alert(e.data.d) }) }; null == a.config ? n.get("./config/config.json").then(function (e) { a.config = e.data, o() }) : o(), e.changeUserType = function (n) { e.userType = n }, e.calculatePrice = function () { var n, o = 0; "Program Prehrane Web" == e.user.application ? (0 == e.user.userType && (o = 550, e.user.version = "START"), 1 == e.user.userType && (o = 950, e.user.version = "STANDARD"), 2 == e.user.userType && (o = 1850, e.user.version = "PREMIUM"), e.user.licence > 1 && (o = o * e.user.licence - o * e.user.licence * (e.user.licence / 10)), e.user.licenceNumber = 1) : (e.user.version = "" == e.user.version ? "PREMIUM" : e.user.version, "START" == e.user.version && (o = "1" == e.user.licence ? 350 : 650), "PREMIUM" == e.user.version && (o = "1" == e.user.licence ? 550 : 950)), n = e.user.licenceNumber > 1 ? o * e.user.licenceNumber - o * e.user.licenceNumber * .1 : o, e.user.price = n, e.user.priceEur = n / a.config.eur }, e.order = function (n, a) { o(), window.location.hash = "order", e.user.application = n, e.user.version = a, e.calculatePrice() }, e.setApplication = function (n) { e.user.application = n, e.calculatePrice() }, e.sendOrder = function (o) { return e.showErrorAlert = !1, "" == o.email || "" == o.firstName || "" == o.lastName || "" == o.address || "" == o.postalCode || "" == o.city || "" == o.country ? (e.showErrorAlert = !0, e.errorMesage = "Sva polja su obavezna.", !1) : 1 != e.userType || "" != o.companyName && "" != o.pin ? (e.sendicon = "fa fa-spinner fa-spin", e.sendicontitle = "Šaljem", e.isSendButtonDisabled = !0, void n({ url: a.config.backend + "Orders.asmx/SendOrder", method: "POST", data: { x: o } }).then(function (n) { e.showAlert = !0, e.showPaymentDetails = !0, window.location.hash = "orderform" }, function (n) { e.showAlert = !1, e.showPaymentDetails = !1, e.sendicon = "fa fa-paper-plane-o", e.sendicontitle = "Pošalji", alert(n.data.d) })) : (e.showErrorAlert = !0, e.errorMesage = "Sva polja su obavezna.", !1) }, e.login = function (o, r) { n({ url: a.config.backend + "Users.asmx/Login", method: "POST", data: { userName: o, password: r } }).then(function (n) { var a = JSON.parse(n.data.d); a.userName == o ? (e.user.firstName = a.firstName, e.user.lastName = a.lastName, e.user.companyName = a.companyName, e.user.address = a.address, e.user.postalCode = a.postalCode, e.user.city = a.city, e.user.country = a.country, e.user.pin = a.pin, e.user.email = a.email, e.showUserDetails = !0, e.showErrorAlert = !1) : (e.showErrorAlert = !0, e.errorMesage = "Korisnik nije pronađen.") }, function (n) { e.errorLogin = !0, e.showErrorAlert = !0, e.errorMesage = "Korisnik nije pronađen.", e.showUserDetails = !1 }) }, e.registration = function () { window.location.hash = "registration" }, e.gotoForm = function () { e.showUserDetails = !0 } }]).controller("contactCtrl", ["$scope", "$http", "$rootScope", function (e, n, a) { e.showAlert = !1, e.sendicon = "fa fa-paper-plane-o", e.sendicontitle = "Pošalji", e.d = { name: "", email: "", message: "" }, e.send = function (o) { null == a.config.backend && a.getConfig(), e.isSendButtonDisabled = !0, e.sendicon = "fa fa-spinner fa-spin", e.sendicontitle = "Šaljem", n({ url: a.config.backend + "Mail.asmx/Send", method: "POST", data: { name: o.name, email: o.email, messageSubject: "Program Prehrane - Upit", message: o.message } }).then(function (n) { e.showAlert = !0, e.sendicon = "fa fa-paper-plane-o", e.sendicontitle = "Pošalji", window.location.hash = "contact" }, function (n) { e.showAlert = !1, e.sendicon = "fa fa-paper-plane-o", e.sendicontitle = "Pošalji", alert(n.data.d) }) } }]);